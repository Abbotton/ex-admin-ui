import"./vue.fe178274.js";import{b as K}from"./@vueuse.61d27e13.js";import{S as R}from"./sortablejs.412b554c.js";import{_ as E,A as te,f as le,g as ae,l as ie,t as M}from"./index.8cbd0a14.js";import{r as _,n as O,z as oe,aW as u,aR as s,at as p,G as N,aV as G,ah as Q,M as B,P as C,au as m,c as o,u as h,ai as F,U as ne,w as P,a as ue,ar as U,as as S,bd as y,W as D,R as se,Q as H,aT as re,aS as de}from"./@vue.9a7efb20.js";import{u as ce}from"./uploader.a74c04fe.js";import{m as z}from"./ant-design-vue.1a08bbd0.js";import"./@babel.6cd0804c.js";import"./regenerator-runtime.8e24db72.js";import"./vue-demi.819cf47c.js";import"./js-md5.5179c6be.js";import"./vue-router.ac7a6022.js";import"./js-cookie.31874410.js";import"./lodash.c9cf1bdb.js";import"./spark-md5.2cc5764b.js";import"./axios.e3200588.js";import"./@ant-design.e295b84c.js";import"./@ctrl.fa7cbd46.js";/* empty css                     */import"./dayjs.38e390ea.js";import"./clipboard.099d05c9.js";import"./markdown-it.80c3a67b.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.c97a8414.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.75eb798b.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./simple-uploader.js.04c42387.js";import"./ali-oss.ce3a624c.js";import"./qiniu-js.8b174ca3.js";import"./querystring.62f12500.js";const pe=["onMouseover"],me={class:"image-tool"},ve={name:"ExImagePreview"},fe=Object.assign(ve,{props:{value:Array,width:{type:Number,default:80},height:{type:Number,default:80}},emits:["update:value"],setup(e,{emit:v}){const f=K(e,"value",v),b=_(),I=_(-1);let d;O(()=>{d=R.create(b.value,{handle:".image",onEnd:l=>{const r=f.value.splice(l.oldIndex,1)[0];f.value.splice(l.newIndex,0,r)}})}),oe(l=>{d&&d.destroy()});function g(l){I.value=l}function c(l){f.value.splice(l,1)}return(l,r)=>{const k=u("caret-left-outlined"),w=u("delete-outlined"),x=u("caret-right-outlined"),j=u("a-image");return s(),p("div",{class:"file-list",ref_key:"sortFileList",ref:b},[(s(!0),p(N,null,G(h(f),($,t)=>(s(),p("div",{class:"image",key:$,style:Q({height:e.height+"px",width:e.width+"px"}),onMouseover:a=>g(t),onMouseout:r[0]||(r[0]=a=>g(-1))},[B(m("div",me,[o(k,{onClick:a=>h(te)(h(f),t)},null,8,["onClick"]),o(w,{onClick:c}),o(x,{onClick:a=>h(le)(h(f),t)},null,8,["onClick"])],512),[[C,I.value==t]]),o(j,{fit:"contain",src:$,width:e.width-2,height:e.height-2,style:{"border-radius":"5%",cursor:"pointer","object-fit":"contain"}},null,8,["src","width","height"])],44,pe))),128))],512)}}});var W=E(fe,[["__scopeId","data-v-ab3d3afe"]]);const ge={class:"file-item"},ye=["href"],_e={class:"file-icon"},he={class:"text"},be={class:"label"},ke={name:"ExFilePreview"},we=Object.assign(ke,{props:{value:Array},emits:["update:value"],setup(e,{emit:v}){const i=e,f=_(),b=K(i,"value",v);O(()=>{R.create(f.value,{handle:".file-item",onEnd:d=>{const g=b.value.splice(d.oldIndex,1)[0];b.value.splice(d.newIndex,0,g)}})});function I(d){b.value.splice(d,1)}return(d,g)=>{const c=u("a-image"),l=u("vertical-align-bottom-outlined"),r=u("delete-outlined"),k=u("check-outlined");return s(),p("div",{ref_key:"sortFileList",ref:f},[(s(!0),p(N,null,G(h(b),w=>(s(),p("div",ge,[m("a",{class:"left",target:"_blank",href:w},[m("div",_e,[o(c,{src:h(ae)(w),width:32,height:32},null,8,["src"])]),o(l,{class:"download"}),m("span",he,F(h(ie)(w)),1)],8,ye),o(r,{onClick:I,class:"delete",style:{cursor:"pointer"}}),m("label",be,[o(k,{class:"success"})])]))),256))],512)}}});var xe=E(we,[["__scopeId","data-v-31a89c14"]]);const Se=e=>(re("data-v-5be75c01"),e=e(),de(),e),Ie={class:"file-upload"},$e=Se(()=>m("i",{class:"far fa-folder-open"},null,-1)),Be={key:2,class:"file-list"},Ce={style:{"font-size":"12px"}},Ue={name:"ExUploader"},Fe=Object.assign(Ue,{props:{value:[String,Array],finder:[Boolean,Object],action:String,options:{type:Object,default:{}},imageWidth:{type:Number,default:80},imageHeight:{type:Number,default:80},type:{type:String,default:"file"},params:{type:Object,default:{}},headers:{type:Object,default:{}},disk:{type:String,default:"local"},driver:{type:String,default:"local"},directory:{type:String,default:""},chunk:{type:Boolean,default:!0},chunkSize:{type:Number,default:1},input:{type:Boolean,default:!1},limit:{type:Number,default:0},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},progress:{type:Boolean,default:!0},onlyShow:{type:Boolean,default:!0},isDirectory:{type:Boolean,default:!1},accept:{type:String,default:"*"},ext:{type:Array,default:[]},fileSize:{type:Number,default:0},domain:{type:String,default:""},accessKey:{type:String,default:""},secretKey:{type:String,default:""},bucket:{type:String,default:""},region:{type:String,default:""},uploadToken:String},emits:["update:value","success","error","progress","fileSubmit","addFile"],setup(e,{emit:v}){const i=e,f={x:"max-content",y:window.innerHeight/2},b=ne(),I=_(),d=_(),g=_(!1),c=_(0),l=_([]),r=_(""),k=_("");P(()=>i.value,t=>{w(t)}),P(l,t=>{i.limit>0&&t.length>i.limit&&(l.value=l.value.slice(0,i.limit)),r.value=t.join("|"),i.multiple?v("update:value",t):v("update:value",r.value)},{deep:!0}),w(i.value);function w(t){i.multiple?l.value=t:t?l.value=[t]:l.value=[]}let x=null;P(()=>i.params,t=>{x.options.params=t}),ue(()=>{x.uploader.cancel(),x=null}),j();function j(){O(()=>{x=ce(i),x.input(d.value),x.watch({addFile:(t,a)=>{if(v("addFile",t,a),i.ext.length>0&&i.ext.indexOf(t.getExtension())===-1)return z.error("\u53EA\u5141\u8BB8\u4E0A\u4F20\u7C7B\u578B\u683C\u5F0F "+i.ext.join(",")),!1;if(i.fileSize>0&&t.size>i.fileSize)return z.error("\u4E0A\u4F20\u6587\u4EF6\u8D85\u51FA\u9650\u5236\u5927\u5C0F"+b.fileSizeText),!1},fileSubmit:t=>{if(v("fileSubmit",t),i.multiple&&i.limit>0&&t.length+l.value.length>i.limit)return z.error("\u6700\u5927\u5141\u8BB8\u4E0A\u4F20"+i.limit+"\u4E2A\u6587\u4EF6"),!1},success:t=>{v("success",t),i.multiple||(l.value=[]),l.value.push(t),c.value=0},verifyProgress:t=>{k.value="\u6821\u9A8C\u4E2D",c.value=t},progress:t=>{v("progress",t),k.value="\u4E0A\u4F20\u4E2D",c.value=t},error:t=>{v("error",t)}})})}function $(t){l.value=r.value.split("|"),l.value=l.value.filter(function(a){return a&&a.trim()})}return(t,a)=>{const T=u("a-input"),q=u("a-popover"),J=u("cloud-upload-outlined"),V=u("a-button"),A=u("a-space"),L=u("a-progress"),X=u("plus-outlined"),Y=u("render"),Z=u("a-form-item-rest"),ee=u("a-modal");return s(),p("div",{class:"uploader",ref_key:"container",ref:I},[e.type=="file"&&!e.onlyShow?(s(),U(xe,{key:0,value:l.value,"onUpdate:value":a[0]||(a[0]=n=>l.value=n)},null,8,["value"])):S("",!0),m("div",Ie,[e.type=="image"?(s(),U(q,{key:0},{content:y(()=>[o(W,{value:l.value,"onUpdate:value":a[1]||(a[1]=n=>l.value=n)},null,8,["value"])]),default:y(()=>[e.input?(s(),U(T,{key:0,value:r.value,"onUpdate:value":a[2]||(a[2]=n=>r.value=n),disabled:e.disabled,onBlur:$,onPressEnter:$,allowClear:""},null,8,["value","disabled"])):S("",!0)]),_:1})):(s(),p(N,{key:1},[e.input?(s(),U(T,{key:0,value:r.value,"onUpdate:value":a[3]||(a[3]=n=>r.value=n),disabled:e.disabled,onBlur:$,onPressEnter:$,allowClear:""},null,8,["value","disabled"])):S("",!0)],64)),e.type=="file"||e.input?(s(),p("span",{key:2,ref_key:"element",ref:d},[D(t.$slots,"default",{},()=>[B(o(A,null,{default:y(()=>[o(V,null,{icon:y(()=>[o(J)]),default:y(()=>[se(" "+F(h(M)("Uploader.upload")),1)]),_:1}),e.finder?(s(),U(V,{key:0,onClick:a[4]||(a[4]=H(n=>g.value=!0,["stop"]))},{icon:y(()=>[$e]),_:1})):S("",!0)]),_:1},512),[[C,e.multiple&&(e.limit==0||l.value.length<e.limit)||l.value.length==0||e.onlyShow]])],!0)],512)):S("",!0)]),(e.type=="file"||e.input)&&!e.progress?(s(),p(N,{key:1},[B(o(L,{status:"active",percent:c.value},null,8,["percent"]),[[C,c.value>0]]),B(m("div",null,F(k.value),513),[[C,c.value>0]])],64)):S("",!0),e.type=="image"&&!e.input?(s(),p("div",Be,[o(W,{value:l.value,"onUpdate:value":a[5]||(a[5]=n=>l.value=n)},null,8,["value"]),B(m("span",{ref_key:"element",ref:d},[D(t.$slots,"default",{},()=>[m("div",{class:"image-btn",style:Q({height:e.imageHeight+"px",width:e.imageWidth+"px"})},[B(o(L,{type:"circle",percent:c.value,width:e.imageHeight},{format:y(n=>[m("div",null,F(n)+"%",1),m("div",Ce,F(k.value),1)]),_:1},8,["percent","width"]),[[C,c.value>0]]),o(A,{direction:"vertical"},{default:y(()=>[B(o(X,null,null,512),[[C,!c.value]]),e.finder?(s(),p("i",{key:0,class:"far fa-folder-open",onClick:a[6]||(a[6]=H(n=>g.value=!0,["stop"]))})):S("",!0)]),_:1})],4)],!0)],512),[[C,e.multiple&&(e.limit==0||l.value.length<e.limit)||l.value.length==0]])])):S("",!0),o(ee,{visible:g.value,"onUpdate:visible":a[8]||(a[8]=n=>g.value=n),width:"70%",getContainer:()=>I.value,title:h(M)("Uploader.finder"),onOk:a[9]||(a[9]=n=>g.value=!1)},{default:y(()=>[o(Z,null,{default:y(()=>[o(Y,{data:e.finder,selection:l.value,"onUpdate:selection":a[7]||(a[7]=n=>l.value=n),"selection-limit":e.limit,"selection-type":e.multiple?"checkbox":"radio",scroll:f},null,8,["data","selection","selection-limit","selection-type"])]),_:1})]),_:1},8,["visible","getContainer","title"])],512)}}});var xt=E(Fe,[["__scopeId","data-v-5be75c01"]]);export{xt as default};
