import"./vue.86160ee8.js";import{d as p}from"./@vueuse.ba71f838.js";import{C,G as b,f as y,c as F}from"./index.0577b630.js";import{l as N}from"./lodash.5cb0a07b.js";import{u as S}from"./remoteOptions.f387ada2.js";import{F as j,a as R}from"./ant-design-vue.d2c27807.js";import{d as A,h as E}from"./@vue.87afd1fa.js";import"./@babel.341e5ec8.js";import"./regenerator-runtime.fb7db526.js";import"./vue-demi.d314a44f.js";import"./js-md5.0a1d8bd7.js";import"./vue-router.5db87406.js";import"./js-cookie.31874410.js";import"./spark-md5.2cc5764b.js";import"./axios.e3200588.js";import"./@ant-design.3f1fc2a3.js";import"./@ctrl.fa7cbd46.js";/* empty css                     */import"./dayjs.a03a5593.js";import"./sortablejs.412b554c.js";import"./clipboard.fdc1e9c9.js";import"./markdown-it.a1b29c6a.js";import"./entities.0d2c0164.js";import"./uc.micro.203ba428.js";import"./mdurl.5ee286b1.js";import"./linkify-it.9fbba5c8.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.b9123e61.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.f91987b9.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";var Vt=A({name:"ExCascader",props:{value:[String,Number,Array],options:Array,remote:Object,loadRemote:Object,cascaderValue:{type:Array,default:[]},single:Boolean},setup(i,o){const n=j.useInjectFormItemContext(),a=p(i,"value",o.emit,{clone:!0}),m=p(i,"options",o.emit,{clone:!0}),{remoteOptionsDebounce:f,remoteOptions:u}=S(i,m),r=o.attrs.fieldNames||{label:"label",value:"value",children:"children",pid:"pid"},c=p(i,"cascaderValue",o.emit,{clone:!0});let h=C();function v(t){if(t===void 0)a.value=o.attrs.multiple?[]:null;else{let e=JSON.parse(JSON.stringify(t));o.attrs.multiple?a.value=g(e):a.value=e.pop()}n.onFieldChange()}i.single&&u(a.value).then(t=>{c.value=O(a.value)});function g(t){let e=[];return t.forEach(s=>{const l=s.pop();o.attrs.changeOnSelect?e.push(l):e=e.concat(V(l))}),N.exports.uniq(e)}function V(t){const e=[t],s=F(i.options,r.value,t,-1,r.children);if(s&&s[r.children])s[r.children].forEach(l=>{d(l,e)});else return[t];return e}function d(t,e=[]){return e.push(t[r.value]),t[r.children]&&t[r.children].forEach(s=>{d(s,e)}),e}function O(t){Array.isArray(t)||(t?t=[t]:t=[]);const e=[];return t.forEach(s=>{e.push(b(m.value,s,r.value,r.pid,r.children).map(l=>l[r.value]))}),!o.attrs.multiple&&!o.attrs.changeOnSelect?e.pop():e}return{options:m,form:h,remoteOptionsDebounce:f,remoteOptions:u,cascaderValue:c,fieldNames:r,updateValue:v}},render(i){let o=Object.assign({options:this.options},i.$attrs,{value:i.cascaderValue,"onUpdate:value":n=>{i.cascaderValue=n,this.updateValue(n)}});return this.remote&&(o.onSearch=n=>{this.remoteOptionsDebounce(n)},o.showSearch=!0),this.loadRemote&&(o.loadData=n=>{const a=n[n.length-1];a.loading=!0,this.loadRemote.data.search=a[this.fieldNames.value],this.form&&(this.loadRemote.data.data=this.form.submitData()),y(this.loadRemote).then(m=>{a.loading=!1,a[this.fieldNames.children]=m.data,this.options=[...this.options]})}),E(R,o,i.$slots)}});export{Vt as default};
