var Y=Object.defineProperty;var E=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var N=(a,d,l)=>d in a?Y(a,d,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[d]=l,P=(a,d)=>{for(var l in d||(d={}))Z.call(d,l)&&N(a,l,d[l]);if(E)for(var l of E(d))ee.call(d,l)&&N(a,l,d[l]);return a};import"./vue.fe178274.js";import{c as te}from"./@vueuse.47cba78b.js";import{S as ae}from"./sortablejs.412b554c.js";import{_ as oe,A as j,t as s,f as G}from"./index.683a2d8d.js";import{l as le}from"./lodash.c9cf1bdb.js";import{r as H,n as ne,a as re,aW as p,aR as n,at as g,ar as c,bd as r,R as m,ai as u,as as f,c as h,G as O,u as e,au as ie,aV as de,W as se,M as S,P as A}from"./@vue.9a7efb20.js";import"./@babel.6cd0804c.js";import"./regenerator-runtime.8e24db72.js";import"./vue-demi.819cf47c.js";import"./js-md5.5179c6be.js";import"./vue-router.ac7a6022.js";import"./js-cookie.31874410.js";import"./ant-design-vue.74d2b37a.js";import"./@ant-design.e295b84c.js";import"./@ctrl.fa7cbd46.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./dayjs.38e390ea.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./spark-md5.2cc5764b.js";import"./axios.e3200588.js";/* empty css                     */import"./clipboard.099d05c9.js";import"./markdown-it.80c3a67b.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.c97a8414.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.75eb798b.js";const ce={class:"hasMany"},me={key:1},ue={key:1},fe={key:0,style:{"margin-top":"5px"}},pe={key:2},ye={name:"ExFormMany"},_e=Object.assign(ye,{props:{value:{type:Array,default:[]},limit:{type:Number,default:0},disabled:Boolean,drag:Boolean,itemData:Object,table:Boolean,field:String,sortField:String,title:String,columns:Array,recursion:{type:Array,default:[]}},emits:["update:value"],setup(a,{emit:d}){const l=a,C=H(-1),F=H(),t=te(l,"value",d);l.sortField&&(t.value=le.exports.sortBy(t.value,l.sortField)),t.value.forEach((o,i)=>(o.ex_admin_id=i+1,o));let w=null;l.drag&&ne(()=>{let o;l.table?o=F.value.table.$el.querySelectorAll(".ant-table-content > table > tbody")[0]:o=F.value,w=ae.create(o,{animation:1e3,handle:".sortHandel",onEnd:i=>{var b=i.newIndex-1,M=i.oldIndex-1;const z=t.value.splice(M,1)[0];t.value.splice(b,0,z)}})}),re(o=>{w&&w.destroy()});function $(){const o=P({},l.itemData);o.ex_admin_id=t.value.length+1,l.sortField&&(o[l.sortField]=t.value.length),t.value.push(o)}function D(o){t.value.splice(o,1),x()}function I(){t.value.splice(0)}function T(o,i){return{onMouseenter:b=>{C.value=i},onMouseleave:b=>{C.value=-1}}}function U(o,i){j(o,i),x()}function W(o,i){G(o,i),x()}function x(){l.sortField&&t.value.forEach((o,i)=>{o[l.sortField]=i})}return(o,i)=>{const b=p("a-divider"),M=p("render"),z=p("caret-up-filled"),q=p("caret-down-filled"),L=p("close-circle-filled"),J=p("a-space"),K=p("drag-outlined"),Q=p("a-tooltip"),X=p("a-table"),k=p("a-button"),R=p("a-form-item");return n(),g("div",ce,[a.title?(n(),c(b,{key:0,orientation:"left"},{default:r(()=>[m(u(a.title),1)]),_:1})):f("",!0),a.table?(n(),g("div",me,[h(X,{"row-key":"ex_admin_id",ref_key:"dragRef",ref:F,scroll:{x:"max-content"},"data-source":e(t),bordered:"",columns:a.columns,size:"small",class:"table",pagination:!1,"custom-row":T},{headerCell:r(({column:_})=>[h(M,{data:_.header},null,8,["data"])]),bodyCell:r(({column:_,record:y,text:B,index:v})=>[_.type=="action"?(n(),c(J,{key:0},{default:r(()=>[a.disabled?f("",!0):(n(),g(O,{key:0},[C.value==v&&e(t).length>1&&v>0?(n(),c(z,{key:0,onClick:V=>e(j)(e(t),v)},{default:r(()=>[m(u(e(s)("FormMany.up")),1)]),_:2},1032,["onClick"])):f("",!0),C.value==v&&e(t).length>1&&v<e(t).length-1?(n(),c(q,{key:1,onClick:V=>e(G)(e(t),v)},{default:r(()=>[m(u(e(s)("FormMany.down")),1)]),_:2},1032,["onClick"])):f("",!0),C.value==v&&e(t).length>0?(n(),c(L,{key:2,style:{color:"red"},type:"dashed",onClick:V=>D(v)},{default:r(()=>[m(u(e(s)("FormMany.remove")),1)]),_:2},1032,["onClick"])):f("",!0)],64))]),_:2},1024)):_.type=="sortDrag"?(n(),g("div",ue,[h(Q,{placement:"right",title:e(s)("Grid.sortDrag")},{default:r(()=>[h(K,{class:"sortHandel","data-field":_.dataIndex,style:{"font-weight":"bold",cursor:"grab"}},null,8,["data-field"])]),_:2},1032,["title"])])):(n(),c(M,{key:2,scopeProp:{$index:v,field:a.field,row:y,recursion:a.recursion},data:_.component},null,8,["scopeProp","data"]))]),_:1},8,["data-source","columns"]),a.disabled?f("",!0):(n(),g("div",fe,[a.limit==0||a.limit>e(t).length?(n(),c(k,{key:0,size:"small",type:"dashed",onClick:$},{default:r(()=>[m(u(e(s)("FormMany.add")),1)]),_:1})):f("",!0),a.limit==0||a.limit>e(t).length?(n(),c(k,{key:1,size:"small",type:"danger",onClick:I},{default:r(()=>[m(u(e(s)("FormMany.clear")),1)]),_:1})):f("",!0)]))])):(n(),g("div",pe,[ie("div",{ref_key:"dragRef",ref:F},[(n(!0),g(O,null,de(e(t),(_,y)=>(n(),g("div",{key:_.ex_admin_id},[se(o.$slots,"default",{$index:y,field:a.field,row:_,recursion:a.recursion},void 0,!0),a.disabled?f("",!0):(n(),c(R,{key:0,label:" ",colon:!1},{default:r(()=>[e(t).length-1==y&&(a.limit==0||a.limit>e(t).length)?(n(),c(k,{key:0,size:"small",type:"dashed",onClick:$},{default:r(()=>[m(u(e(s)("FormMany.add")),1)]),_:1})):f("",!0),S(h(k,{size:"small",type:"dashed",onClick:B=>D(y)},{default:r(()=>[m(u(e(s)("FormMany.remove")),1)]),_:2},1032,["onClick"]),[[A,e(t).length>0]]),S(h(k,{size:"small",onClick:B=>U(e(t),y)},{default:r(()=>[m(u(e(s)("FormMany.up")),1)]),_:2},1032,["onClick"]),[[A,e(t).length>1&&y>0]]),S(h(k,{size:"small",onClick:B=>W(e(t),y)},{default:r(()=>[m(u(e(s)("FormMany.down")),1)]),_:2},1032,["onClick"]),[[A,e(t).length>1&&y<e(t).length-1]]),e(t).length-1==y&&(a.limit==0||a.limit>e(t).length)?(n(),c(k,{key:1,size:"small",type:"dashed",onClick:I},{default:r(()=>[m(u(e(s)("FormMany.clear")),1)]),_:1})):f("",!0)]),_:2},1024)),h(b)]))),128))],512),e(t).length==0&&!a.disabled?(n(),c(R,{key:0,label:" ",colon:!1},{default:r(()=>[h(k,{size:"small",type:"dashed",onClick:$},{default:r(()=>[m(u(e(s)("FormMany.add")),1)]),_:1})]),_:1})):f("",!0)]))])}}});var nt=oe(_e,[["__scopeId","data-v-708168f8"]]);export{nt as default};
