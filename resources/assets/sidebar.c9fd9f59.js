import"./vue.4c5758a0.js";import{u as X}from"./use-http.7a563404.js";import{_ as Z,h as $,t as q,i as G}from"./index.d316568f.js";import{r as _,w as J,aX as p,Z as l,$ as m,bd as h,aw as c,c as y,ax as K,u as f,_ as k,S as V,an as F}from"./@vue.87afd1fa.js";import"./@babel.dd651e2b.js";import"./regenerator-runtime.8e24db72.js";import"./js-md5.3cdd41c4.js";import"./vue-router.9a2c52dc.js";import"./js-cookie.31874410.js";import"./ant-design-vue.e954adc4.js";import"./@ant-design.8c82b126.js";import"./@ctrl.fa7cbd46.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./dayjs.0743a87f.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./lodash.28c974ad.js";import"./spark-md5.2cc5764b.js";import"./@vueuse.67682d36.js";import"./vue-demi.24ed2461.js";import"./axios.e3200588.js";/* empty css                     */import"./sortablejs.412b554c.js";import"./clipboard.89482ba1.js";import"./markdown-it.39ce48f9.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.169105cf.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.52338b19.js";const Q={class:"ex_scrollbar"},R={key:0,class:"flex"},W={style:{color:"#f50"}},Y={key:0,class:"action"},ee={key:1,class:"flex"},te={key:0,class:"action"},ae={name:"ExSidebar",inheritAttrs:!1},oe=Object.assign(ae,{props:{hideAll:Boolean,hideAdd:Boolean,hideEdit:Boolean,hideDel:Boolean,hideFilter:Boolean,hideTools:Boolean,isTree:Boolean,tools:[Object,Boolean],value:[String,Number],sourceList:{type:Array,default:[]},default:{type:[String,Number],default:void 0},field:{type:String,default:"group_id"},selectedField:String,fieldNames:Object,url:String,params:{type:Object,default:{}}},emits:["update:value"],setup(d,{emit:v}){const o=d,{loading:ne,http:j}=X();let N,x=o.fieldNames.children,i=o.fieldNames.key,r=o.fieldNames.title;o.default!==void 0&&v("update:value",o.default);const S=_([o.default]),s=_(""),b=_(-1),B=_(o.sourceList.map(e=>e[i])),O=_(!0),D=_(T(o.sourceList)),E=(e,t)=>{for(let n=0;n<t.length;n++){const u=t[n];u[x]&&(u[x].some(A=>A[i]===e)?N=u[i]:E(e,u[x])&&(N=E(e,u[x])))}return N},w=e=>{B.value=e,O.value=!1};J(s,e=>{B.value=o.sourceList.map(t=>t[r].indexOf(e)>-1?E(t[i],D.value):null).filter((t,n,u)=>t&&u.indexOf(t)===n),s.value=e,O.value=!0});const C=(e,t)=>{if(t.selected){const n=e[0];o.selectedField?v("update:value",t.node[o.selectedField]):v("update:value",n)}else v("update:value",null)};function T(e){if(o.isTree&&(e=$(e,i,o.fieldNames.pid,x)),e.length==0&&(S.value=[""],v("update:value","")),!o.hideAll){const t={};t[i]="",t[r]=q("Sidebar.all"),t.ex_admin_render={name:"html",attribute:{"data-tag":"span"},content:{default:[t[r]]}},e.unshift(t)}return e}G.on(e=>{e=="Success"&&g()});function g(){j({url:o.url,method:"post",data:o.params}).then(e=>{D.value=T(e)})}function L(e){let t=e.node[i];t&&(b.value=t)}function M(){b.value=-1}return(e,t)=>{const n=p("render"),u=p("reload-outlined"),A=p("a-button"),z=p("a-space"),I=p("search-outlined"),P=p("a-input"),U=p("a-tree"),H=p("a-card");return l(),m(H,{style:{height:"100%"},bodyStyle:{padding:"10px",height:"100%",display:"flex",flexDirection:"column"}},{default:h(()=>[d.hideTools?c("",!0):(l(),m(z,{key:0,style:{"margin-bottom":"10px"},size:10},{default:h(()=>[d.hideAdd?c("",!0):(l(),m(n,{key:0,data:d.tools.add},null,8,["data"])),y(A,{shape:"circle",size:"small",onClick:g},{icon:h(()=>[y(u)]),_:1})]),_:1})),d.hideFilter?c("",!0):(l(),m(P,{key:1,value:s.value,"onUpdate:value":t[0]||(t[0]=a=>s.value=a),style:{"margin-bottom":"8px"}},{prefix:h(()=>[y(I,{style:{color:"#c0c4cc"}})]),_:1},8,["value"])),K("div",Q,[y(U,{"expanded-keys":B.value,"tree-data":D.value,"auto-expand-parent":O.value,fieldNames:d.fieldNames,onExpand:w,onSelect:C,onMouseenter:L,onMouseleave:M,"block-node":"",selectedKeys:S.value,"onUpdate:selectedKeys":t[1]||(t[1]=a=>S.value=a)},{title:h(a=>[s.value&&a[f(r)]&&a[f(r)].indexOf(s.value)>-1?(l(),k("span",R,[K("span",null,[V(F(a[f(r)].substr(0,a[f(r)].indexOf(s.value)))+" ",1),K("span",W,F(s.value),1),V(" "+F(a[f(r)].substr(a[f(r)].indexOf(s.value)+s.value.length)),1)]),b.value==a[f(i)]&&(a.ex_admin_edit||a.ex_admin_delete)?(l(),k("span",Y,[d.hideEdit?c("",!0):(l(),m(n,{key:0,data:a.ex_admin_edit},null,8,["data"])),d.hideDel?c("",!0):(l(),m(n,{key:1,data:a.ex_admin_delete,onSuccess:g},null,8,["data"]))])):c("",!0)])):(l(),k("span",ee,[y(n,{data:a.ex_admin_render},null,8,["data"]),b.value==a[f(i)]&&(a.ex_admin_edit||a.ex_admin_delete)?(l(),k("span",te,[d.hideEdit?c("",!0):(l(),m(n,{key:0,data:a.ex_admin_edit},null,8,["data"])),d.hideDel?c("",!0):(l(),m(n,{key:1,data:a.ex_admin_delete,onSuccess:g},null,8,["data"]))])):c("",!0)]))]),_:1},8,["expanded-keys","tree-data","auto-expand-parent","fieldNames","selectedKeys"])])]),_:1})}}});var qe=Z(oe,[["__scopeId","data-v-b6eb703a"]]);export{qe as default};
