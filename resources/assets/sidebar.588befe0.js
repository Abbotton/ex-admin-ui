import"./vue.f169bc0e.js";import{u as U}from"./use-http.3a41e54b.js";import{b as z,t as H}from"./index.9a3c7168.js";import{r as v,w as E,Y as p,Z as r,_ as m,$ as x,a5 as h,c as K,a1 as T,u,a0 as V,I as j,a4 as b}from"./@vue.a2bdcbc4.js";import"./vue-router.0de480eb.js";import"./js-md5.216a9fc2.js";import"./@babel.7a426183.js";import"./regenerator-runtime.59ce731c.js";import"./spark-md5.2cc5764b.js";import"./axios.e3200588.js";import"./ant-design-vue.e653cb26.js";import"./@ant-design.594a5492.js";import"./@ctrl.fa7cbd46.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.8a2ffed6.js";import"./dayjs.76d34158.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./js-cookie.31874410.js";/* empty css                     */import"./lodash.5fa5cd01.js";import"./clipboard.76283100.js";const I={class:"scrollbar"},Y={key:0},Z={style:{color:"#f50"}},$={key:1},q={name:"ExSidebar",inheritAttrs:!1},be=Object.assign(q,{props:{hideAll:Boolean,hideAdd:Boolean,hideEdit:Boolean,hideDel:Boolean,hideFilter:Boolean,hideTools:Boolean,isTree:Boolean,tools:[Object,Boolean],value:[String,Number],sourceList:{type:Array,default:[]},default:{type:[String,Number],default:""},field:{type:String,default:"group_id"},fieldNames:Object,url:String,params:{type:Object,default:{}}},emits:["update:value"],setup(o,{emit:g}){const a=o,{loading:G,http:C}=U();let N,f=a.fieldNames.children,c=a.fieldNames.key,s=a.fieldNames.title;a.default&&g("update:value",a.default);const y=v([a.default]),n=v(""),k=v(a.sourceList.map(e=>e[c])),_=v(!0),B=v(D(a.sourceList)),S=(e,t)=>{for(let i=0;i<t.length;i++){const d=t[i];d[f]&&(d[f].some(A=>A[c]===e)?N=d[c]:S(e,d[f])&&(N=S(e,d[f])))}return N},L=e=>{k.value=e,_.value=!1};E(n,e=>{k.value=a.sourceList.map(t=>t[s].indexOf(e)>-1?S(t[c],B.value):null).filter((t,i,d)=>t&&d.indexOf(t)===i),n.value=e,_.value=!0}),E(y,e=>{const t=e[0];a.tools&&(a.tools.del.directive[0].value.data.ids=[t],a.tools.edit.attribute.reference.event.Click.custom[0].params.data.id=t),g("update:value",t)});function D(e){if(a.isTree&&(e=z(e,c,a.fieldNames.pid,f)),e.length==0&&(y.value=[""],g("update:value","")),!a.hideAll){const t={};t[c]="",t[s]=H("Sidebar.all"),e.unshift(t)}return e}function O(){C({url:a.url,method:"post",data:a.params}).then(e=>{B.value=D(e)})}return(e,t)=>{const i=p("render"),d=p("a-space"),A=p("search-outlined"),w=p("a-input"),F=p("a-tree"),P=p("a-card");return r(),m(P,{style:{height:"100%"},bodyStyle:{padding:"10px",height:"100%",display:"flex",flexDirection:"column"}},{default:x(()=>[o.hideTools?h("",!0):(r(),m(d,{key:0,style:{"margin-bottom":"10px"},size:15},{default:x(()=>[o.hideAdd?h("",!0):(r(),m(i,{key:0,data:o.tools.add,onSuccess:O},null,8,["data"])),o.hideEdit?h("",!0):(r(),m(i,{key:1,disabled:!o.value,data:o.tools.edit,onSuccess:O},null,8,["disabled","data"])),o.hideDel?h("",!0):(r(),m(i,{key:2,disabled:!o.value,data:o.tools.del,onSuccess:O},null,8,["disabled","data"]))]),_:1})),o.hideFilter?h("",!0):(r(),m(w,{key:1,value:n.value,"onUpdate:value":t[0]||(t[0]=l=>n.value=l),style:{"margin-bottom":"8px"}},{prefix:x(()=>[K(A,{style:{color:"#c0c4cc"}})]),_:1},8,["value"])),T("div",I,[K(F,{"expanded-keys":k.value,"tree-data":B.value,"auto-expand-parent":_.value,fieldNames:o.fieldNames,onExpand:L,selectedKeys:y.value,"onUpdate:selectedKeys":t[1]||(t[1]=l=>y.value=l)},{title:x(l=>[l[u(s)]&&l[u(s)].indexOf(n.value)>-1?(r(),V("span",Y,[j(b(l[u(s)].substr(0,l[u(s)].indexOf(n.value)))+" ",1),T("span",Z,b(n.value),1),j(" "+b(l[u(s)].substr(u(s).indexOf(n.value)+n.value.length)),1)])):(r(),V("span",$,b(l[u(s)]),1))]),_:1},8,["expanded-keys","tree-data","auto-expand-parent","fieldNames","selectedKeys"])])]),_:1})}}});export{be as default};
