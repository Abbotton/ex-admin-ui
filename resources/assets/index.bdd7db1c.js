var xe=Object.defineProperty;var Ce=Object.getOwnPropertySymbols;var Ae=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var Me=(e,i,F)=>i in e?xe(e,i,{enumerable:!0,configurable:!0,writable:!0,value:F}):e[i]=F,we=(e,i)=>{for(var F in i||(i={}))Ae.call(i,F)&&Me(e,F,i[F]);if(Ce)for(var F of Ce(i))Ee.call(i,F)&&Me(e,F,i[F]);return e};import{_ as De,s as g,w as ae,x as be,f as ye}from"./index.74cb3636.js";import{l as he}from"./lodash.c9cf1bdb.js";import"./vue.db505ee4.js";import{d as Oe}from"./vuedraggable.e7e6f001.js";import{d as $e,q as Se,r as Fe,a as Ve,t as Ne,aW as p,aR as _,ar as I,bd as l,c as o,at as A,aV as H,S as v,ai as y,H as J,as as E,au as m,R as O,af as de,ah as Ue,U as qe,aT as Le,aS as ze}from"./@vue.cb43a243.js";import{M as Ie}from"./ant-design-vue.6b10f349.js";import"./js-md5.5179c6be.js";import"./@babel.6cd0804c.js";import"./regenerator-runtime.8e24db72.js";import"./vue-router.a08742b9.js";import"./js-cookie.31874410.js";import"./spark-md5.2cc5764b.js";import"./@vueuse.81e70e6d.js";import"./vue-demi.5fb18120.js";import"./axios.e3200588.js";import"./@ant-design.bcfb08ae.js";import"./@ctrl.fa7cbd46.js";/* empty css                     */import"./dayjs.38e390ea.js";import"./sortablejs.412b554c.js";import"./clipboard.099d05c9.js";import"./markdown-it.80c3a67b.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.c97a8414.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.86f7507c.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";const Be=$e({name:"ExCurd",components:{draggable:Oe},setup(){const e=Se({tables:[],controller:[],controllerIndex:-1,newController:{table:"",title:"",name:""},newMethod:{title:"",name:"",type:""},method:[],methodIndex:-1,drawingMain:{component:null,ref:null},componentList:[],settingForm:null,settingFormVisible:!0,tableVisible:!1,tableModalRender:null,tableTreeNode:null,tableModalTitle:null,index:-1,database:null,isSave:!0,methodTypes:[{value:"grid",label:"\u6570\u636E\u8868\u683C(grid)"},{value:"form",label:"\u8868\u5355(form)"},{value:"detail",label:"\u8BE6\u60C5(detail)"}]}),i=Fe(),F=Fe();M(),addEventListener("keydown",re),addEventListener("keyup",X),Ve(()=>{removeEventListener("keydown",re),removeEventListener("keyup",X)});let K=0,Q=0;function re(t){t.keyCode==17&&(K=1),t.keyCode==83&&(Q=1),K==1&&Q==1&&U()}function X(t){t.keyCode==17&&(K=0),t.keyCode==83&&(Q=0)}function Y(){x()}function M(){D(),B(),g("ex-admin/plugin-curd-controller-Index/getFormComponent").then(t=>{e.componentList=t.data})}function k(t){for(let n in t.content){let d=he.exports.cloneDeep(t.content),r=[];d[n].forEach(s=>{r.push(s),k(s)}),["ExForm","ARow","ACol"].indexOf(t.name)>-1&&(t.content[n]=S(t.name,r,t))}}function C(t){return $(t,!0)}function $(t,n=!1){let d;return n?d=t.draggedContext.element.component.name:d=t.draggedContext.element.name,!(d=="ACol"&&t.relatedContext.component.$attrs.group.name!="ARow"||d!="ACol"&&t.relatedContext.component.$attrs.group.name=="ARow")}function S(t,n,d={}){let r="";return t=="ARow"?r="curd-children-row":t=="ACol"&&(r="curd-row-draggable"),[{name:"DraggableRender",attribute:{group:{name:t,put:!0,pull:!0},animation:1e3,chosenClass:"ex-drag-choose",list:n,tag:t=="ARow"?"render":"div",componentData:{data:d},class:r,style:{width:"100%"},move:s=>$(s)},event:{End:s=>{_e()},Sort:s=>{e.drawingMain.ref.forceUpdate()},Choose:s=>{document.querySelectorAll("[data-choose]").forEach(f=>{f.removeAttribute("data-choose")}),s.item.setAttribute("data-choose",!0);let c=s.item.__draggable_context.element;c.name==="AFormItem"?e.settingForm=c.content.default[0].attribute.drawingForm:c.name=="DraggableRender"?e.settingForm=c.attribute.componentData.data.attribute.drawingForm:e.settingForm=c.attribute.drawingForm}}}]}const x=he.exports.debounce(N,150);function V(t){t.forEach(n=>{if(typeof n=="object"){if(n.name=="AFormItem"){const d=e.drawingMain.component,r=d.bindAttribute.model,s=d.bind[r];let c=n,f=c.content.default[0],P=f.attribute.drawingForm,h=P.bind[P.bindAttribute.model];for(let b in h)if(b=="title")c.attribute.label=h[b];else if(!(["name","default"].indexOf(b)>-1))if(b=="required")c.attribute.required=h[b];else if(b=="field"&&f.name!="ACascader"){let w=r+"."+h[b];f.bindAttribute[h.modelValue]=w,f.modelBind[h.modelValue]=w,c.attribute.name=[h[b]],P.content.default.forEach(T=>{if(T.attribute.name.indexOf("default")>-1)s[h[b]]=s[T.content.default[0].bindAttribute.value.replace(r+".","")],h.default=s[h[b]],T.content.default[0].bindAttribute.value=w,T.content.default[0].modelBind.value=w;else if(f.name==="ARangePicker"&&T.attribute.title==="\u9ED8\u8BA4\u503C"){s[h[b]]=s[T.content.default[0].bindAttribute.value.replace(r+".","")],h.default=s[h[b]],T.content.default[0].bindAttribute.value=w,T.content.default[0].modelBind.value=w;const G=f.attribute.startField;f.attribute.startField=r+"."+G.substr(G.indexOf(".")+1);const ve=f.attribute.endField;f.attribute.endField=r+"."+ve.substr(ve.indexOf(".")+1)}})}else if(["character","addonBefore","addonAfter","prefix","suffix"].indexOf(b)>-1&&h[b]){let w=qe(h[b]);Array.isArray(w)?f.content[b]=w:f.content[b]=[w]}else if(b==="config"){for(let w in h[b])w=="options"&&h[b].options_type==3&&(f.attribute.options=[],Object.assign(f.attribute.options,h[b][w]));if(f.name=="ExSelectTable"){let w="ex-admin/"+h[b].grid_class.replaceAll("\\","-")+"/"+h[b].grid_method,T={};h[b].params.forEach(G=>{T[G.var]=G.value}),ae(f.attribute,"gridUrl",w),ae(f.attribute,"params",T)}}else ae(f.attribute,b,h[b])}else if(n.name=="DraggableRender")n.attribute.key=be(20),V(n.attribute.list);else if(n.name=="ARow"||n.name=="ACol"){let d=n.attribute.drawingForm,r=d.bind[d.bindAttribute.model];delete n.attribute.md,delete n.attribute.sm,delete n.attribute.xs;for(let s in r)ae(n.attribute,s,r[s])}n.content&&n.content.default&&V(n.content.default)}})}function N(){const t=e.drawingMain.component;let n=t.attribute.drawingForm,d=n.bind[n.bindAttribute.model];if(t.name=="ExForm")Object.assign(t.attribute,d),t.content.default||(t.content.default=[]),V(t.content.default);else if(t.name=="ExGrid"){const r=[];for(let s in d)s=="columns"?(d[s].forEach(c=>{r.push({dataIndex:c.field,title:c.label,type:c.form_type||"",header:{name:"html",attribute:{class:"ex_admin_table_th_name","data-tag":"span"},content:{default:[c.label]}}})}),d.switch.indexOf("hideAction")==-1&&r.push({dataIndex:"ExAdminAction",title:"",header:{name:"html",attribute:{class:"ex_admin_table_th_name","data-tag":"span"},content:{default:[""]}}}),t.attribute.columns=r):s=="switch"?d.swtichOptions.forEach(c=>{t.attribute[c]=d[s].indexOf(c)>-1}):t.attribute[s]=d[s]}else if(t.name=="ADescriptions")for(let r in d)if(r=="items"){const s=[];d[r].forEach(c=>{var f;s.push({name:"ADescriptionsItem",attribute:{title:c.label,span:c.span},content:{default:[(f=t.attribute.data[c.field])!=null?f:"--"],label:[c.label]}})}),t.content.default=s}else t.attribute[r]=d[r];e.drawingMain.ref.forceUpdate(),e.isSave=!1}function z(t,n){t.forEach(d=>{let r;if(typeof d=="object"){if(d.name=="AFormItem"){const s=e.drawingMain.component;let c=d.content.default[0].attribute.drawingForm,f=c.bindAttribute.model;ye(c.bind[f],c.attribute.exceptField||[]);const P=s.bindAttribute.model,h=s.bind[P];c.bind[f].default=h[c.bind[f].field],n.push(c.bind[f]),r=c.bind[f]}else if(d.name=="DraggableRender")z(d.attribute.list,n);else if(d.name=="ARow"||d.name=="ACol"){let s=d.attribute.drawingForm,c=s.bindAttribute.model;ye(s.bind[c],s.attribute.exceptField||[]),n.push(s.bind[c]),r=s.bind[c]}d.content&&d.content.default&&(r.content=[],z(d.content.default,r.content))}})}function U(){x(),setTimeout(()=>{let t={};const n=e.drawingMain.component;let d=n.attribute.drawingForm.bindAttribute.model;t.config=n.attribute.drawingForm.bind[d],n.name=="ExForm"?(t.type="form",t.component=[],z(n.content.default,t.component)):n.name=="ExGrid"?t.type="grid":n.name=="ADescriptions"&&(t.type="detail"),g({url:"ex-admin/plugin-curd-controller-Index/save",method:"post",data:{id:e.method[e.methodIndex].id,controller:e.controller[e.controllerIndex].name,class:e.controller[e.controllerIndex].class,function:e.method[e.methodIndex].name,setting:t}}).then(r=>{a(e.methodIndex,!1),e.isSave=!0})},500)}function Z(t){e.drawingMain.ref=t}function D(){g("ex-admin/plugin-curd-controller-Index/getController").then(t=>{e.controller=t.data})}function B(){g("ex-admin/plugin-curd-controller-Database/getTable").then(t=>{e.tables=t.data.map(n=>(n.tableName=n.name,n.dataRef=n,n.name=n.id,n.children=[],n.class="table-tree-node",n))})}function q(t){if(e.tableVisible=!1,!t){B();return}return new Promise(n=>{g("ex-admin/plugin-curd-controller-Database/getTableColumn?table="+t.dataRef.id).then(d=>{t.dataRef.children=d.data.map(r=>(r.id=t.id+r.field,r.name=r.field,r.table=t.id,r.parent=t,r.isLeaf=!0,r)),e.tables=[...e.tables],n()})})}function ee(t){Ie.confirm({title:"\u5220\u9664\u8868",content:"\u786E\u8BA4\u5220\u9664\u8868\uFF0C\u4E0D\u53EF\u6062\u590D\uFF1F",onOk(){g.delete("/ex-admin/plugin-curd-controller-Database/grid",{data:{ex_admin_action:"delete",ex_admin_sidebar:!0,ids:[t]}}).then(n=>{B()})}})}function j(t,n,d){Ie.confirm({title:"\u5220\u9664\u8868\u5B57\u6BB5",content:"\u786E\u8BA4\u5220\u9664\u8868\u5B57\u6BB5\uFF0C\u4E0D\u53EF\u6062\u590D\uFF1F",onOk(){g.delete("/ex-admin/plugin-curd-controller-Database/grid",{data:{ex_admin_action:"delete",ex_admin_trashed:"false",table:t,ids:[n]}}).then(r=>{q(d)})}})}function L(t,n,d){e.tableTreeNode=d,e.tableModalTitle="\u7F16\u8F91\u5B57\u6BB5",e.tableModalRender=null,g.put("/ex-admin/plugin-curd-controller-Database/form",{table:t,field:n}).then(r=>{e.tableVisible=!0,e.tableModalRender=r,e.tableModalRender.footer=r.content.footer[0],delete e.tableModalRender.content.footer})}function ie(){e.tableTreeNode=null,e.tableModalTitle="\u6DFB\u52A0\u8868",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/tableForm").then(t=>{e.tableVisible=!0,e.tableModalRender=t,e.tableModalRender.footer=t.content.footer[0],delete e.tableModalRender.content.footer})}function te(){e.tableTreeNode=null,e.tableModalTitle="\u8868\u9884\u8BBE\u5B57\u6BB5",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/presetFields").then(t=>{e.tableVisible=!0,e.tableModalRender=t,e.tableModalRender.footer=t.content.footer[0],delete e.tableModalRender.content.footer})}function se(t){e.tableTreeNode=null,e.tableModalTitle="\u7F16\u8F91\u8868",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/tableForm",{id:t}).then(n=>{e.tableVisible=!0,e.tableModalRender=n,e.tableModalRender.footer=n.content.footer[0],delete e.tableModalRender.content.footer})}function ue(t){e.tableModalTitle="\u5173\u8054\u8868(\u6A21\u578B)",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/modelRelationForm",{table:t}).then(n=>{e.tableVisible=!0,e.tableModalRender=n,e.tableModalRender.footer=n.content.footer[0],delete e.tableModalRender.content.footer})}function ce(t){e.tableModalTitle="\u6DFB\u52A0\u8868\u5B57\u6BB5",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/form",{table:t}).then(n=>{e.tableVisible=!0,e.tableModalRender=n,e.tableModalRender.footer=n.content.footer[0],delete e.tableModalRender.content.footer})}function ne(t){e.methodIndex=-1,g({url:"ex-admin/plugin-curd-controller-Index/getMethod",method:"post",data:{id:t}}).then(n=>{e.method=n.data})}function oe(){g({url:"ex-admin/plugin-curd-controller-Index/deleteMethod",method:"post",data:{class:e.controller[e.controllerIndex].class,controller:e.controller[e.controllerIndex].name,method:e.method[e.methodIndex].name,id:e.method[e.methodIndex].id}}).then(t=>{e.methodIndex=-1,e.method.splice(e.methodIndex,1)})}function me(){const t=e.controller[e.controllerIndex].class,n=e.method[e.methodIndex];g({url:"ex-admin/plugin-curd-controller-Index/updateMethod",method:"post",data:{controller:t,id:n.id,name:n.name,title:n.title,updateTitle:n.updateTitle,updateName:n.updateName}}).then(d=>{e.method[e.methodIndex].title=n.updateTitle,e.method[e.methodIndex].name=n.updateName})}function W(t,n,d){g({url:"ex-admin/plugin-curd-controller-Index/createController",method:"post",data:{name:n,title:t,table:d}}).then(r=>{e.newController.title="",e.newController.table="",e.newController.name="",D()})}function le(t,n,d){g({url:"ex-admin/plugin-curd-controller-Index/createMethod",method:"post",data:{controller_id:e.controller[e.controllerIndex].id,class:e.controller[e.controllerIndex].class,controller:e.controller[e.controllerIndex].name,table:e.controller[e.controllerIndex].table,name:n,type:d,title:t}}).then(r=>{e.newMethod.title="",e.newMethod.name="",e.newMethod.type="",e.method.push({name:n,title:t,updateTitle:t,updateName:n}),g({url:"ex-admin/plugin-curd-controller-Index/createMethodInit",method:"post",data:{class:e.controller[e.controllerIndex].class,name:n,type:d}}).then(s=>{ne(e.controller[e.controllerIndex].id)})})}function pe(){const t=e.controller[e.controllerIndex];g({url:"ex-admin/plugin-curd-controller-Index/updateController",method:"post",data:{id:t.id,path:t.path,class:t.class,title:t.title,updateName:t.name}}).then(n=>{D()})}function fe(){const t=e.controller[e.controllerIndex];g({url:"ex-admin/plugin-curd-controller-Index/deleteController",method:"post",data:{id:t.id,path:t.path}}).then(n=>{e.controllerIndex=-1,D(),e.method=[]})}function a(t,n=!0){e.methodIndex=t,e.settingForm=null,g({url:"ex-admin/plugin-curd-controller-Index/render",method:"post",data:{class:e.controller[e.controllerIndex].class,function:e.method[e.methodIndex].name,var:[]}}).then(d=>{e.isSave=!0,k(d.data),e.drawingMain.component=d.data})}function u(t,n){n.mouseenter=!0,e.tableTreeNode=n,e.tables=[...e.tables]}function R(t,n){n.mouseenter=!1,e.tables=[...e.tables]}function ke(t){t.newIndex!==t.oldIndex&&g.post("ex-admin/plugin-curd-controller-Database/sortField",{table:t.item.__draggable_context.element.table,field:t.item.__draggable_context.element.field,sort:t.newIndex})}function Re(t){if(!t.component)return!1;let n=he.exports.cloneDeep(t.component);if(n.name=="AFormItem"){let d=n.content.default[0].attribute.drawingForm,r=d.bind[d.bindAttribute.model];d.attribute.key=be(20),r.field||(r.field=be(20)),n.attribute.validateFormField=e.drawingMain.component.bindAttribute.validateField}if(n.name=="ARow"){let d=[],r=[];n.content.default[0].content={default:S("ACol",r)},d=n.content.default,n.content={default:S(n.name,d,n)}}else if(n.name=="ACol"){let d=[];n.content={default:S(n.name,d,n)}}return n}function _e(t){N()}function Te(t){return!(!t.relatedContext.element.table&&!t.draggedContext.element.component)}return we({onFieldMove:Te,onMove:$,onCloneMove:C,onEnd:_e,onClone:Re,relationTable:ue,onFieldSort:ke,addTable:ie,presetFields:te,editTableField:L,editTable:se,deleteTable:ee,addTableField:ce,tableMouseLeave:R,tableMouseenter:u,onLoadTable:q,deleteTableField:j,getController:D,watchModel:Y,dragSave:U,getRender:a,getMethod:ne,deleteMethod:oe,updateMethod:me,createController:W,createMethod:le,updateController:pe,deleteController:fe,dragRef:i,drawingRef:F,setRef:Z},Ne(e))}}),ge=e=>(Le("data-v-872ac81c"),e=e(),ze(),e),je=v("\u4FDD\u5B58 "),We=v(" \u6DFB\u52A0 "),Pe=v(" \u4FDD\u5B58 "),Ge=v(" \u7F16\u8F91 "),He=v(" \u5220\u9664 "),Je={class:"flex-column"},Ke={class:"title"},Qe=ge(()=>m("span",null,"\u63A7\u5236\u5668",-1)),Xe={class:"flex-1-auto"},Ye=["onContextmenu","onClick"],Ze={class:"name"},et={class:"desc"},tt=v(" \u4FDD\u5B58 "),nt=v(" \u6DFB\u52A0 "),ot=v(" \u4FDD\u5B58 "),lt=v(" \u7F16\u8F91 "),at=v(" \u5220\u9664 "),dt={class:"flex-column"},rt={class:"title"},it=ge(()=>m("span",null,"\u65B9\u6CD5",-1)),st={class:"flex-1-auto"},ut=["onContextmenu","onClick"],ct={class:"name"},mt={class:"desc"},pt={class:"flex-column"},ft=v("\u6DFB\u52A0\u8868"),bt=v("\u8868\u9884\u8BBE\u5B57\u6BB5"),ht=["onMouseenter","onMouseleave"],gt={class:"table-tree-title"},_t=["title"],vt={key:0,class:"table-tree-action-table"},Ct=["title"],Mt=["onMouseenter","onMouseleave"],wt={class:"table-tree-title"},yt=["title"],Ft={key:0,class:"table-tree-action"},It=["title"],kt={class:"components"},Rt={style:{display:"flex","align-items":"center",margin:"5px"}},Tt=ge(()=>m("i",{class:"fas fa-layer-group"},null,-1)),xt={style:{"margin-left":"5px"}},At={class:"components-draggable"},Et={class:"components-item"},Dt={class:"components-body"},Ot={class:"header"},$t=v("(ctrl+s)"),St={class:"drawing scrollbar",ref:"drawingRef"};function Vt(e,i,F,K,Q,re){const X=p("a-select-option"),Y=p("a-select"),M=p("a-form-item"),k=p("a-input"),C=p("a-button"),$=p("a-form"),S=p("PlusOutlined"),x=p("a-menu-item"),V=p("a-popover"),N=p("EditOutlined"),z=p("question-circle-outlined"),U=p("DeleteOutlined"),Z=p("a-popconfirm"),D=p("a-menu"),B=p("ReloadOutlined"),q=p("a-tooltip"),ee=p("a-dropdown"),j=p("a-layout-sider"),L=p("render"),ie=p("a-modal"),te=p("a-space"),se=p("FolderOutlined"),ue=p("reload-outlined"),ce=p("NodeIndexOutlined"),ne=p("FileOutlined"),oe=p("draggable"),me=p("a-sub-menu"),W=p("a-tab-pane"),le=p("a-tabs"),pe=p("a-layout-content"),fe=p("a-layout");return _(),I(fe,{class:"layout"},{default:l(()=>[o(j,{width:130,class:"controller scrollbar"},{default:l(()=>[o(ee,{trigger:["contextmenu"]},{overlay:l(()=>[o(D,null,{default:l(()=>[o(V,{trigger:"click",placement:"right"},{content:l(()=>[o($,{"label-col":{span:7},model:e.newController,onFinish:i[3]||(i[3]=a=>e.createController(e.newController.title,e.newController.name,e.newController.table))},{default:l(()=>[o(M,{label:"\u6570\u636E\u8868",name:"table",required:""},{default:l(()=>[o(Y,{value:e.newController.table,"onUpdate:value":i[0]||(i[0]=a=>e.newController.table=a),"dropdown-match-select-width":400,showSearch:""},{default:l(()=>[(_(!0),A(J,null,H(e.tables,a=>(_(),I(X,{value:a.id},{default:l(()=>[v(y(a.tableName),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1}),o(M,{label:"\u6807\u9898",name:"title",required:""},{default:l(()=>[o(k,{value:e.newController.title,"onUpdate:value":i[1]||(i[1]=a=>e.newController.title=a)},null,8,["value"])]),_:1}),o(M,{label:"\u540D\u79F0",name:"name",required:""},{default:l(()=>[o(k,{value:e.newController.name,"onUpdate:value":i[2]||(i[2]=a=>e.newController.name=a)},null,8,["value"])]),_:1}),o(M,{"wrapper-col":{offset:6},style:{"margin-bottom":"5px"}},{default:l(()=>[o(C,{type:"primary","html-type":"submit"},{default:l(()=>[je]),_:1})]),_:1})]),_:1},8,["model"])]),default:l(()=>[o(x,null,{icon:l(()=>[o(S)]),default:l(()=>[We]),_:1})]),_:1}),e.controllerIndex>-1?(_(),I(V,{key:0,trigger:"click",placement:"right"},{content:l(()=>[o($,{"label-col":{span:6},model:e.controller[e.controllerIndex],onFinish:e.updateController},{default:l(()=>[o(M,{name:"title",label:"\u6807\u9898",required:""},{default:l(()=>[o(k,{value:e.controller[e.controllerIndex].title,"onUpdate:value":i[4]||(i[4]=a=>e.controller[e.controllerIndex].title=a)},null,8,["value"])]),_:1}),o(M,{name:"name",label:"\u540D\u79F0",required:""},{default:l(()=>[o(k,{value:e.controller[e.controllerIndex].name,"onUpdate:value":i[5]||(i[5]=a=>e.controller[e.controllerIndex].name=a)},null,8,["value"])]),_:1}),o(M,{"wrapper-col":{offset:6},style:{"margin-bottom":"5px"}},{default:l(()=>[o(C,{type:"primary","html-type":"submit"},{default:l(()=>[Pe]),_:1})]),_:1})]),_:1},8,["model","onFinish"])]),default:l(()=>[o(x,null,{icon:l(()=>[o(N)]),default:l(()=>[Ge]),_:1})]),_:1})):E("",!0),e.controllerIndex>-1?(_(),I(Z,{key:1,title:"\u786E\u8BA4\u5220\u9664\uFF1F",onConfirm:i[6]||(i[6]=a=>e.deleteController())},{icon:l(()=>[o(z,{style:{color:"red"}})]),default:l(()=>[o(x,null,{icon:l(()=>[o(U)]),default:l(()=>[He]),_:1})]),_:1})):E("",!0)]),_:1})]),default:l(()=>[m("div",Je,[m("div",Ke,[Qe,o(C,{size:"small",shape:"circle",onClick:e.getController},{icon:l(()=>[o(B)]),_:1},8,["onClick"])]),m("ul",Xe,[(_(!0),A(J,null,H(e.controller,(a,u)=>(_(),A("li",{key:u,onContextmenu:O(R=>e.controllerIndex=u,["prevent"]),onClick:R=>{e.controllerIndex=u,e.getMethod(a.id)},class:de(e.controllerIndex==u?"active":"")},[o(q,{placement:"bottom",mouseEnterDelay:1},{title:l(()=>[v(y(a.title),1)]),default:l(()=>[m("div",Ze,y(a.title),1)]),_:2},1024),o(q,{placement:"bottom",mouseEnterDelay:1},{title:l(()=>[v(y(a.path),1)]),default:l(()=>[m("div",et,y(a.name),1)]),_:2},1024)],42,Ye))),128))])])]),_:1})]),_:1}),o(j,{width:130,class:"controller scrollbar"},{default:l(()=>[o(ee,{trigger:["contextmenu"]},{overlay:l(()=>[o(D,null,{default:l(()=>[o(V,{trigger:"click",placement:"right"},{content:l(()=>[o($,{"label-col":{span:6},model:e.newMethod,onFinish:i[10]||(i[10]=a=>e.createMethod(e.newMethod.title,e.newMethod.name,e.newMethod.type))},{default:l(()=>[o(M,{label:"\u7C7B\u578B",name:"type",required:""},{default:l(()=>[o(Y,{value:e.newMethod.type,"onUpdate:value":i[7]||(i[7]=a=>e.newMethod.type=a),options:e.methodTypes},null,8,["value","options"])]),_:1}),o(M,{label:"\u6807\u9898",name:"title",required:""},{default:l(()=>[o(k,{value:e.newMethod.title,"onUpdate:value":i[8]||(i[8]=a=>e.newMethod.title=a)},null,8,["value"])]),_:1}),o(M,{label:"\u540D\u79F0",name:"name",required:""},{default:l(()=>[o(k,{value:e.newMethod.name,"onUpdate:value":i[9]||(i[9]=a=>e.newMethod.name=a)},null,8,["value"])]),_:1}),o(M,{"wrapper-col":{offset:6},style:{"margin-bottom":"5px"}},{default:l(()=>[o(C,{type:"primary","html-type":"submit"},{default:l(()=>[tt]),_:1})]),_:1})]),_:1},8,["model"])]),default:l(()=>[o(x,null,{icon:l(()=>[o(S)]),default:l(()=>[nt]),_:1})]),_:1}),e.methodIndex>-1?(_(),I(V,{key:0,trigger:"click",placement:"right"},{content:l(()=>[o($,{"label-col":{span:6},model:e.method[e.methodIndex],onFinish:e.updateMethod},{default:l(()=>[o(M,{name:"updateTitle",label:"\u6807\u9898",required:""},{default:l(()=>[o(k,{value:e.method[e.methodIndex].updateTitle,"onUpdate:value":i[11]||(i[11]=a=>e.method[e.methodIndex].updateTitle=a)},null,8,["value"])]),_:1}),o(M,{name:"updateName",label:"\u540D\u79F0",required:""},{default:l(()=>[o(k,{value:e.method[e.methodIndex].updateName,"onUpdate:value":i[12]||(i[12]=a=>e.method[e.methodIndex].updateName=a)},null,8,["value"])]),_:1}),o(M,{"wrapper-col":{offset:6},style:{"margin-bottom":"5px"}},{default:l(()=>[o(C,{type:"primary","html-type":"submit"},{default:l(()=>[ot]),_:1})]),_:1})]),_:1},8,["model","onFinish"])]),default:l(()=>[o(x,null,{icon:l(()=>[o(N)]),default:l(()=>[lt]),_:1})]),_:1})):E("",!0),e.methodIndex>-1?(_(),I(Z,{key:1,title:"\u786E\u8BA4\u5220\u9664\uFF1F",onConfirm:i[13]||(i[13]=a=>e.deleteMethod())},{icon:l(()=>[o(z,{style:{color:"red"}})]),default:l(()=>[o(x,null,{icon:l(()=>[o(U)]),default:l(()=>[at]),_:1})]),_:1})):E("",!0)]),_:1})]),default:l(()=>[m("div",dt,[m("div",rt,[it,o(C,{size:"small",shape:"circle",onClick:i[14]||(i[14]=a=>e.getMethod(e.controller[e.controllerIndex].id))},{icon:l(()=>[o(B)]),_:1})]),m("ul",st,[(_(!0),A(J,null,H(e.method,(a,u)=>(_(),A("li",{key:u,onContextmenu:O(R=>e.methodIndex=u,["prevent"]),onClick:R=>e.getRender(u),class:de(e.methodIndex==u?"active":"")},[o(q,{placement:"bottom",mouseEnterDelay:1},{title:l(()=>[v(y(a.title),1)]),default:l(()=>[m("div",ct,y(a.title),1)]),_:2},1024),o(q,{placement:"bottom",mouseEnterDelay:1},{title:l(()=>[v(y(a.name),1)]),default:l(()=>[m("div",mt,y(a.name),1)]),_:2},1024)],42,ut))),128))])])]),_:1})]),_:1}),o(j,{width:300,class:"scrollbar",ref:"dragRef"},{default:l(()=>[o(le,{type:"card",class:"curd-tabs"},{default:l(()=>[o(W,{key:"1",tab:"\u6570\u636E\u5E93",style:{height:"100%"}},{default:l(()=>[o(ie,{visible:e.tableVisible,"onUpdate:visible":i[16]||(i[16]=a=>e.tableVisible=a),title:e.tableModalTitle,width:"1000px"},{footer:l(()=>[e.tableModalRender?(_(),I(L,{key:0,data:e.tableModalRender.footer},null,8,["data"])):E("",!0)]),default:l(()=>[o(L,{data:e.tableModalRender,onSuccess:i[15]||(i[15]=a=>e.onLoadTable(e.tableTreeNode))},null,8,["data"])]),_:1},8,["visible","title"]),m("div",pt,[o(te,{style:{margin:"0 10px 10px 10px"}},{default:l(()=>[o(C,{onClick:e.addTable},{default:l(()=>[ft]),_:1},8,["onClick"]),o(C,{onClick:e.presetFields},{default:l(()=>[bt]),_:1},8,["onClick"])]),_:1}),o(D,{mode:"inline",class:"curd-table-tree",selectable:!1},{default:l(()=>[(_(!0),A(J,null,H(e.tables,a=>(_(),I(me,{key:a.id,onTitleClick:u=>e.onLoadTable(a)},{title:l(()=>[m("div",{onMouseenter:u=>e.tableMouseenter(u,a),onMouseleave:u=>e.tableMouseLeave(u,a)},[m("div",gt,[o(se),m("div",{class:"field-title",title:a.name},y(a.name),9,_t),a.mouseenter?(_(),A("div",vt,[o(C,{shape:"circle",size:"small",onClick:O(u=>e.onLoadTable(a),["stop"])},{icon:l(()=>[o(ue)]),_:2},1032,["onClick"]),o(C,{shape:"circle",size:"small",onClick:O(u=>e.addTableField(a.id),["stop"])},{icon:l(()=>[o(S)]),_:2},1032,["onClick"]),o(C,{shape:"circle",size:"small",onClick:O(u=>e.editTable(a.id),["stop"])},{icon:l(()=>[o(N)]),_:2},1032,["onClick"]),o(C,{shape:"circle",size:"small",onClick:O(u=>e.relationTable(a.id),["stop"])},{icon:l(()=>[o(ce)]),_:2},1032,["onClick"]),o(C,{shape:"circle",size:"small",onClick:O(u=>e.deleteTable(a.id),["stop"])},{icon:l(()=>[o(U)]),_:2},1032,["onClick"])])):E("",!0)]),m("div",{class:"field-title-desc",title:a.comment},y(a.comment),9,Ct)],40,ht)]),default:l(()=>[o(oe,{style:{width:"100%"},list:a.children,onSort:e.onFieldSort,clone:e.onClone,move:e.onFieldMove,onEnd:e.onEnd,group:{pull:"clone",put:!1},"item-key":"id"},{item:l(({element:u})=>[m("div",{onMouseenter:R=>e.tableMouseenter(R,u),onMouseleave:R=>e.tableMouseLeave(R,u)},[(_(),I(x,{key:u.id},{default:l(()=>[m("div",wt,[o(ne),m("div",{class:"field-title",title:u.name},y(u.name),9,yt),u.mouseenter?(_(),A("div",Ft,[o(C,{shape:"circle",size:"small",onClick:O(R=>e.editTableField(a.id,u.field,a),["stop"])},{icon:l(()=>[o(N)]),_:2},1032,["onClick"]),o(C,{shape:"circle",size:"small",onClick:O(R=>e.deleteTableField(a.id,u.field,a),["stop"])},{icon:l(()=>[o(U)]),_:2},1032,["onClick"])])):E("",!0)]),m("div",{class:"field-title-desc",title:u.comment},y(u.comment),9,It)]),_:2},1024))],40,Mt)]),_:2},1032,["list","onSort","clone","move","onEnd"])]),_:2},1032,["onTitleClick"]))),128))]),_:1})])]),_:1}),o(W,{key:"2",tab:"\u8868\u5355\u8BBE\u8BA1",forceRender:""},{default:l(()=>[(_(!0),A(J,null,H(e.componentList,a=>(_(),A("div",kt,[m("div",Rt,[Tt,m("div",xt,y(a.label),1)]),m("div",At,[o(oe,{list:a.options,sort:!1,clone:e.onClone,onEnd:e.onEnd,move:e.onCloneMove,"chosen-class":"chosen-class",group:{name:"components",pull:"clone",put:!1}},{item:l(({element:u})=>[m("div",Et,[m("div",Dt,[m("i",{class:de(u.icon)},null,2),v(" "+y(u.label),1)])])]),_:2},1032,["list","clone","onEnd","move"])])]))),256))]),_:1})]),_:1})]),_:1},512),o(pe,{class:"main"},{default:l(()=>[m("div",Ot,[o(te,null,{default:l(()=>[o(C,{onClick:e.dragSave},{default:l(()=>[m("span",{style:Ue(e.isSave?"":"color: red;")},"\u4FDD\u5B58",4),$t]),_:1},8,["onClick"])]),_:1})]),m("div",St,[o(L,{ref:a=>e.setRef(a),data:e.drawingMain.component},null,8,["data"])],512)]),_:1}),m("div",{class:"collapse",onClick:i[17]||(i[17]=a=>e.settingFormVisible=!e.settingFormVisible)},[m("i",{class:de(e.settingFormVisible?"fas fa-angle-double-right":"fas fa-angle-double-left")},null,2)]),e.settingFormVisible?(_(),I(j,{key:0,width:360,class:"settingForm scrollbar"},{default:l(()=>[o(le,{type:"card",class:"curd-tabs"},{default:l(()=>[e.settingForm?(_(),I(W,{key:"1",tab:"\u7EC4\u4EF6\u5C5E\u6027"},{default:l(()=>[o(L,{data:e.settingForm,onWatchModel:e.watchModel},null,8,["data","onWatchModel"])]),_:1})):E("",!0),o(W,{key:"2",tab:"\u5C5E\u6027",forceRender:""},{default:l(()=>[e.drawingMain.component?(_(),I(L,{key:0,data:e.drawingMain.component.attribute.drawingForm,onWatchModel:e.watchModel},null,8,["data","onWatchModel"])):E("",!0)]),_:1})]),_:1})]),_:1})):E("",!0)]),_:1})}var Rn=De(Be,[["render",Vt],["__scopeId","data-v-872ac81c"]]);export{Rn as default};
