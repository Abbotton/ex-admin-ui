import"./vue.ba0abfb8.js";import{b as W}from"./@vueuse.dbb03eba.js";import{S as K}from"./sortablejs.412b554c.js";import{_ as E,A as ee,f as te,g as le,l as ae,t as L}from"./index.87ae8e72.js";import{r as k,n as O,z as ie,aW as u,aR as r,at as m,G as N,aV as R,ah as G,M as S,P as $,au as v,c as o,u as h,ai as F,U as oe,w as P,a as ne,ar as C,as as x,bd as _,W as M,R as se,Q as D,aT as ue,aS as re}from"./@vue.cfb5b4bf.js";import{u as de}from"./uploader.2a7606eb.js";import{m as z}from"./ant-design-vue.5301e143.js";import"./vue-demi.a71c3140.js";import"./vue-router.49809928.js";import"./js-md5.5179c6be.js";import"./@babel.6cd0804c.js";import"./regenerator-runtime.8e24db72.js";import"./lodash.c9cf1bdb.js";import"./spark-md5.2cc5764b.js";import"./axios.e3200588.js";import"./js-cookie.31874410.js";import"./@ant-design.8f7116f5.js";import"./@ctrl.fa7cbd46.js";/* empty css                     */import"./dayjs.38e390ea.js";import"./clipboard.099d05c9.js";import"./markdown-it.20180ffc.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.1971588a.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.8a2ffed6.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./simple-uploader.js.04c42387.js";import"./ali-oss.ce3a624c.js";import"./qiniu-js.8b174ca3.js";import"./querystring.62f12500.js";const ce=["onMouseover"],pe={class:"image-tool"},me={name:"ExImagePreview"},ve=Object.assign(me,{props:{value:Array,width:{type:Number,default:80},height:{type:Number,default:80}},emits:["update:value"],setup(e,{emit:f}){const g=W(e,"value",f),b=k(),w=k(-1);let d;O(()=>{d=K.create(b.value,{handle:".image",onEnd:n=>{const y=g.value.splice(n.oldIndex,1)[0];g.value.splice(n.newIndex,0,y)}})}),ie(n=>{d&&d.destroy()});function c(n){w.value=n}function a(n){g.value.splice(n,1)}return(n,y)=>{const I=u("caret-left-outlined"),p=u("delete-outlined"),j=u("caret-right-outlined"),B=u("a-image");return r(),m("div",{class:"file-list",ref_key:"sortFileList",ref:b},[(r(!0),m(N,null,R(h(g),(t,l)=>(r(),m("div",{class:"image",key:t,style:G({height:e.height+"px",width:e.width+"px"}),onMouseover:U=>c(l),onMouseout:y[0]||(y[0]=U=>c(-1))},[S(v("div",pe,[o(I,{onClick:U=>h(ee)(h(g),l)},null,8,["onClick"]),o(p,{onClick:a}),o(j,{onClick:U=>h(te)(h(g),l)},null,8,["onClick"])],512),[[$,w.value==l]]),o(B,{fit:"contain",src:t,width:e.width-2,height:e.height-2,style:{"border-radius":"5%",cursor:"pointer","object-fit":"contain"}},null,8,["src","width","height"])],44,ce))),128))],512)}}});var H=E(ve,[["__scopeId","data-v-ab3d3afe"]]);const fe={class:"file-item"},ge=["href"],ye={class:"file-icon"},_e={class:"text"},he={class:"label"},be={name:"ExFilePreview"},ke=Object.assign(be,{props:{value:Array},emits:["update:value"],setup(e,{emit:f}){const i=e,g=k(),b=W(i,"value",f);O(()=>{K.create(g.value,{handle:".file-item",onEnd:d=>{const c=b.value.splice(d.oldIndex,1)[0];b.value.splice(d.newIndex,0,c)}})});function w(d){b.value.splice(d,1)}return(d,c)=>{const a=u("a-image"),n=u("vertical-align-bottom-outlined"),y=u("delete-outlined"),I=u("check-outlined");return r(),m("div",{ref_key:"sortFileList",ref:g},[(r(!0),m(N,null,R(h(b),p=>(r(),m("div",fe,[v("a",{class:"left",target:"_blank",href:p},[v("div",ye,[o(a,{src:h(le)(p),width:32,height:32},null,8,["src"])]),o(n,{class:"download"}),v("span",_e,F(h(ae)(p)),1)],8,ge),o(y,{onClick:w,class:"delete",style:{cursor:"pointer"}}),v("label",he,[o(I,{class:"success"})])]))),256))],512)}}});var we=E(ke,[["__scopeId","data-v-31a89c14"]]);const xe=e=>(ue("data-v-e60af6a2"),e=e(),re(),e),Se={class:"uploader"},$e={class:"file-upload"},Ie=xe(()=>v("i",{class:"far fa-folder-open"},null,-1)),Be={key:2,class:"file-list"},Ue={style:{"font-size":"12px"}},Ce={name:"ExUploader"},Fe=Object.assign(Ce,{props:{value:[String,Array],finder:[Boolean,Object],action:String,options:{type:Object,default:{}},imageWidth:{type:Number,default:80},imageHeight:{type:Number,default:80},type:{type:String,default:"file"},params:{type:Object,default:{}},headers:{type:Object,default:{}},disk:{type:String,default:"local"},driver:{type:String,default:"local"},directory:{type:String,default:""},chunk:{type:Boolean,default:!0},chunkSize:{type:Number,default:1},input:{type:Boolean,default:!1},limit:{type:Number,default:0},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},progress:{type:Boolean,default:!0},onlyShow:{type:Boolean,default:!0},isDirectory:{type:Boolean,default:!1},accept:{type:String,default:"*"},ext:{type:Array,default:[]},fileSize:{type:Number,default:0},domain:{type:String,default:""},accessKey:{type:String,default:""},secretKey:{type:String,default:""},bucket:{type:String,default:""},region:{type:String,default:""},uploadToken:String},emits:["update:value","success","error","progress","fileSubmit","addFile"],setup(e,{emit:f}){const i=e,g={x:"max-content",y:window.innerHeight/2},b=oe(),w=k(),d=k(!1),c=k(0),a=k([]),n=k(""),y=k("");P(()=>i.value,t=>{I(t)}),P(a,t=>{i.limit>0&&t.length>i.limit&&(a.value=a.value.slice(0,i.limit)),n.value=t.join("|"),i.multiple?f("update:value",t):f("update:value",n.value)},{deep:!0}),I(i.value);function I(t){i.multiple?a.value=t:t?a.value=[t]:a.value=[]}let p=null;P(()=>i.params,t=>{p.options.params=t}),ne(()=>{p.uploader.cancel(),p=null}),j();function j(){O(()=>{p=de(i),p.input(w.value),p.watch({addFile:(t,l)=>{if(f("addFile",t,l),i.ext.length>0&&i.ext.indexOf(t.getExtension())===-1)return z.error("\u53EA\u5141\u8BB8\u4E0A\u4F20\u7C7B\u578B\u683C\u5F0F "+i.ext.join(",")),!1;if(i.fileSize>0&&t.size>i.fileSize)return z.error("\u4E0A\u4F20\u6587\u4EF6\u8D85\u51FA\u9650\u5236\u5927\u5C0F"+b.fileSizeText),!1},fileSubmit:t=>{if(f("fileSubmit",t),i.multiple&&i.limit>0&&t.length+a.value.length>i.limit)return z.error("\u6700\u5927\u5141\u8BB8\u4E0A\u4F20"+i.limit+"\u4E2A\u6587\u4EF6"),!1},success:t=>{f("success",t),i.multiple||(a.value=[]),a.value.push(t),console.log(a),c.value=0},verifyProgress:t=>{y.value="\u6821\u9A8C\u4E2D",c.value=t},progress:t=>{f("progress",t),y.value="\u4E0A\u4F20\u4E2D",c.value=t},error:t=>{f("error",t)}})})}function B(t){a.value=n.value.split("|"),a.value=a.value.filter(function(l){return l&&l.trim()})}return(t,l)=>{const U=u("a-input"),Q=u("a-popover"),q=u("cloud-upload-outlined"),T=u("a-button"),V=u("a-space"),A=u("a-progress"),J=u("plus-outlined"),X=u("render"),Y=u("a-form-item-rest"),Z=u("a-modal");return r(),m("div",Se,[e.type=="file"&&!e.onlyShow?(r(),C(we,{key:0,value:a.value,"onUpdate:value":l[0]||(l[0]=s=>a.value=s)},null,8,["value"])):x("",!0),v("div",$e,[e.type=="image"?(r(),C(Q,{key:0},{content:_(()=>[o(H,{value:a.value,"onUpdate:value":l[1]||(l[1]=s=>a.value=s)},null,8,["value"])]),default:_(()=>[e.input?(r(),C(U,{key:0,value:n.value,"onUpdate:value":l[2]||(l[2]=s=>n.value=s),disabled:e.disabled,onBlur:B,onPressEnter:B,allowClear:""},null,8,["value","disabled"])):x("",!0)]),_:1})):(r(),m(N,{key:1},[e.input?(r(),C(U,{key:0,value:n.value,"onUpdate:value":l[3]||(l[3]=s=>n.value=s),disabled:e.disabled,onBlur:B,onPressEnter:B,allowClear:""},null,8,["value","disabled"])):x("",!0)],64)),e.type=="file"||e.input?(r(),m("span",{key:2,ref_key:"element",ref:w},[M(t.$slots,"default",{},()=>[S(o(V,null,{default:_(()=>[o(T,null,{icon:_(()=>[o(q)]),default:_(()=>[se(" "+F(h(L)("Uploader.upload")),1)]),_:1}),e.finder?(r(),C(T,{key:0,onClick:l[4]||(l[4]=D(s=>d.value=!0,["stop"]))},{icon:_(()=>[Ie]),_:1})):x("",!0)]),_:1},512),[[$,e.multiple&&(e.limit==0||a.value.length<e.limit)||a.value.length==0||e.onlyShow]])],!0)],512)):x("",!0)]),(e.type=="file"||e.input)&&!e.progress?(r(),m(N,{key:1},[S(o(A,{status:"active",percent:c.value},null,8,["percent"]),[[$,c.value>0]]),S(v("div",null,F(y.value),513),[[$,c.value>0]])],64)):x("",!0),e.type=="image"&&!e.input?(r(),m("div",Be,[o(H,{value:a.value,"onUpdate:value":l[5]||(l[5]=s=>a.value=s)},null,8,["value"]),S(v("span",{ref_key:"element",ref:w},[M(t.$slots,"default",{},()=>[v("div",{class:"image-btn",style:G({height:e.imageHeight+"px",width:e.imageWidth+"px"})},[S(o(A,{type:"circle",percent:c.value,width:e.imageHeight},{format:_(s=>[v("div",null,F(s)+"%",1),v("div",Ue,F(y.value),1)]),_:1},8,["percent","width"]),[[$,c.value>0]]),o(V,{direction:"vertical"},{default:_(()=>[S(o(J,null,null,512),[[$,!c.value]]),e.finder?(r(),m("i",{key:0,class:"far fa-folder-open",onClick:l[6]||(l[6]=D(s=>d.value=!0,["stop"]))})):x("",!0)]),_:1})],4)],!0)],512),[[$,e.multiple&&(e.limit==0||a.value.length<e.limit)||a.value.length==0]])])):x("",!0),o(Z,{visible:d.value,"onUpdate:visible":l[8]||(l[8]=s=>d.value=s),width:"70%",title:h(L)("Uploader.finder"),onOk:l[9]||(l[9]=s=>d.value=!1)},{default:_(()=>[o(Y,null,{default:_(()=>[o(X,{data:e.finder,selection:a.value,"onUpdate:selection":l[7]||(l[7]=s=>a.value=s),"selection-limit":e.limit,"selection-type":e.multiple?"checkbox":"radio",scroll:g},null,8,["data","selection","selection-limit","selection-type"])]),_:1})]),_:1},8,["visible","title"])])}}});var wt=E(Fe,[["__scopeId","data-v-e60af6a2"]]);export{wt as default};
