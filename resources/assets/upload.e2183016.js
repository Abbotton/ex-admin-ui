import"./vue.4c5758a0.js";import{d as Z}from"./@vueuse.67682d36.js";import{S as G}from"./sortablejs.412b554c.js";import{_ as H,A as ne,p as oe,q as se,r as ue,t as X}from"./index.269634d6.js";import{r as _,n as M,z as re,aX as s,u as f,Z as u,_ as g,H as V,aW as J,a3 as Y,N as C,Q as U,ax as c,c as n,aw as x,an as j,V as de,w as L,a as ce,$ as T,bd as w,X as q,S as pe,R as Q,a2 as me,aU as ve,aT as fe}from"./@vue.87afd1fa.js";import{u as ge}from"./uploader.83412142.js";import{m as D}from"./ant-design-vue.e954adc4.js";import"./@babel.dd651e2b.js";import"./regenerator-runtime.8e24db72.js";import"./vue-demi.24ed2461.js";import"./js-md5.3cdd41c4.js";import"./vue-router.9a2c52dc.js";import"./js-cookie.31874410.js";import"./lodash.28c974ad.js";import"./spark-md5.2cc5764b.js";import"./axios.e3200588.js";import"./@ant-design.8c82b126.js";import"./@ctrl.fa7cbd46.js";/* empty css                     */import"./dayjs.0743a87f.js";import"./clipboard.89482ba1.js";import"./markdown-it.39ce48f9.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.169105cf.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.52338b19.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./simple-uploader.js.c04b5c64.js";import"./ali-oss.2ae0dd0c.js";import"./qiniu-js.8b174ca3.js";import"./querystring.62f12500.js";const ye=["onMouseover"],he={class:"image-tool"},_e={name:"ExImagePreview"},be=Object.assign(_e,{props:{value:Array,width:{type:Number,default:80},height:{type:Number,default:80}},emits:["update:value"],setup(e,{emit:y}){const p=Z(e,"value",y),b=_(),$=_(-1);let d;M(()=>{d=G.create(b.value,{handle:".image",onEnd:l=>{const r=p.value.splice(l.oldIndex,1)[0];p.value.splice(l.newIndex,0,r)}})}),re(l=>{d&&d.destroy()});function h(l){$.value=l}function m(l){p.value.splice(l,1)}return(l,r)=>{const S=s("caret-left-outlined"),k=s("delete-outlined"),N=s("caret-right-outlined"),z=s("a-image");return f(p).length>0?(u(),g("div",{key:0,class:"file-list",ref_key:"sortFileList",ref:b},[(u(!0),g(V,null,J(f(p),(E,F)=>(u(),g("div",{class:"image",key:E,style:Y({height:e.height+"px",width:e.width+"px"}),onMouseover:v=>h(F),onMouseout:r[0]||(r[0]=v=>h(-1))},[C(c("div",he,[n(S,{onClick:v=>f(ne)(f(p),F)},null,8,["onClick"]),n(k,{onClick:v=>m(F)},null,8,["onClick"]),n(N,{onClick:v=>f(oe)(f(p),F)},null,8,["onClick"])],512),[[U,$.value==F]]),n(z,{fit:"contain",src:E,width:e.width-2,height:e.height-2,style:{"border-radius":"5%",cursor:"pointer","object-fit":"contain"}},null,8,["src","width","height"])],44,ye))),128))],512)):x("",!0)}}});var R=H(be,[["__scopeId","data-v-ad0c1774"]]);const ke={class:"file-item"},we=["href"],xe={class:"file-icon"},Se={class:"text"},Fe={class:"label"},$e={name:"ExFilePreview"},Be=Object.assign($e,{props:{value:Array},emits:["update:value"],setup(e,{emit:y}){const i=e,p=_(),b=Z(i,"value",y);M(()=>{G.create(p.value,{handle:".file-item",onEnd:d=>{const h=b.value.splice(d.oldIndex,1)[0];b.value.splice(d.newIndex,0,h)}})});function $(d){b.value.splice(d,1)}return(d,h)=>{const m=s("a-image"),l=s("vertical-align-bottom-outlined"),r=s("delete-outlined"),S=s("check-outlined");return f(b).length>0?(u(),g("div",{key:0,ref_key:"sortFileList",ref:p},[(u(!0),g(V,null,J(f(b),(k,N)=>(u(),g("div",ke,[c("a",{class:"left",target:"_blank",href:k},[c("div",xe,[n(m,{src:f(se)(k),width:32,height:32},null,8,["src"])]),n(l,{class:"download"}),c("span",Se,j(f(ue)(k)),1)],8,we),n(r,{onClick:z=>$(N),class:"delete",style:{cursor:"pointer"}},null,8,["onClick"]),c("label",Fe,[n(S,{class:"success"})])]))),256))],512)):x("",!0)}}});var Ie=H(Be,[["__scopeId","data-v-b6c69410"]]);const ee=e=>(ve("data-v-7637d388"),e=e(),fe(),e),Ce=["title"],Ue={class:"file-upload"},Ne=ee(()=>c("i",{class:"far fa-folder-open"},null,-1)),Pe={key:2,class:"file-list"},je={style:{"font-size":"12px"}},ze=ee(()=>c("i",{class:"fas fa-plus"},null,-1)),Ee={name:"ExUploader"},Oe=Object.assign(Ee,{props:{value:[String,Array],finder:[Boolean,Object],action:String,options:{type:Object,default:{}},imageWidth:{type:Number,default:80},imageHeight:{type:Number,default:80},type:{type:String,default:"file"},params:{type:Object,default:{}},headers:{type:Object,default:{}},disk:{type:String,default:"local"},driver:{type:String,default:"local"},directory:{type:String,default:""},hideFinder:{type:Boolean,default:!1},chunk:{type:Boolean,default:!0},chunkSize:{type:Number,default:1},input:{type:Boolean,default:!1},limit:{type:Number,default:0},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},paste:{type:Boolean,default:!1},progress:{type:Boolean,default:!0},saveFinder:{type:Boolean,default:!0},onlyShow:{type:Boolean,default:!0},isDirectory:{type:Boolean,default:!1},accept:{type:String,default:"*"},ext:{type:Array,default:[]},fileSize:{type:Number,default:0},domain:{type:String,default:""},accessKey:{type:String,default:""},secretKey:{type:String,default:""},bucket:{type:String,default:""},region:{type:String,default:""},uploadToken:String},emits:["update:value","success","error","progress","fileSubmit","addFile"],setup(e,{emit:y}){const i=e,p={x:"max-content",y:window.innerHeight/2},b=de(),$=_(),d=_(),h=_(!1),m=_(0),l=_([]),r=_(""),S=_(""),k=_(!1);L(()=>i.value,t=>{F(t)}),L(l,t=>{i.limit>0&&t.length>i.limit&&(l.value=l.value.slice(0,i.limit)),r.value=t.join("|"),i.multiple?y("update:value",t):y("update:value",r.value)},{deep:!0}),F(i.multiple?[...i.value]:i.value);function N(t){k.value=!1}function z(t){k.value=!0}function E(t){if(k.value){t=t.originalEvent||t;let a,B,I,A,P;for(a=t.clipboardData.items,I=0,A=a.length;I<A;I++)B=a[I],!(B.kind!=="file"||!(P=B.getAsFile()))&&v.uploader.addFile(P)}}function F(t){i.multiple?l.value=t:t?l.value=[t]:l.value=[]}let v=null;L(()=>i.params,t=>{v.options.params=t}),ce(()=>{v.uploader.cancel(),v=null}),te();function te(){M(()=>{v=ge(i),v.input(d.value),v.watch({addFile:(t,a)=>{if(y("addFile",t,a),i.ext.length>0&&i.ext.indexOf(t.getExtension())===-1)return D.error("\u53EA\u5141\u8BB8\u4E0A\u4F20\u7C7B\u578B\u683C\u5F0F "+i.ext.join(",")),!1;if(i.fileSize>0&&t.size>i.fileSize)return D.error("\u4E0A\u4F20\u6587\u4EF6\u8D85\u51FA\u9650\u5236\u5927\u5C0F"+b.fileSizeText),!1},fileSubmit:t=>{if(y("fileSubmit",t),i.multiple&&i.limit>0&&t.length+l.value.length>i.limit)return D.error("\u6700\u5927\u5141\u8BB8\u4E0A\u4F20"+i.limit+"\u4E2A\u6587\u4EF6"),!1},success:t=>{y("success",t),i.multiple||(l.value=[]),l.value.push(t),m.value=0},verifyProgress:t=>{S.value="\u6821\u9A8C\u4E2D",m.value=t},progress:t=>{y("progress",t),S.value="\u4E0A\u4F20\u4E2D",m.value=t},error:t=>{y("error",t)}})})}function O(t){l.value=r.value.split("|"),l.value=l.value.filter(function(a){return a&&a.trim()})}return(t,a)=>{const B=s("a-input"),I=s("a-popover"),A=s("cloud-upload-outlined"),P=s("a-button"),W=s("a-space"),K=s("a-progress"),le=s("render"),ae=s("a-form-item-rest"),ie=s("a-modal");return u(),g("div",{class:me(["uploader",e.paste?"paste":"",e.paste&&k.value?"pasteFocus":""]),ref_key:"container",ref:$,title:e.paste?"\u7C98\u8D34\u4E0A\u4F20":"",onPaste:E,onFocus:z,onBlur:N,tabindex:"-1"},[e.type=="file"&&!e.onlyShow?(u(),T(Ie,{key:0,value:l.value,"onUpdate:value":a[0]||(a[0]=o=>l.value=o)},null,8,["value"])):x("",!0),c("div",Ue,[e.type=="image"&&e.input?(u(),T(I,{key:0},{content:w(()=>[n(R,{value:l.value,"onUpdate:value":a[1]||(a[1]=o=>l.value=o)},null,8,["value"])]),default:w(()=>[n(B,{value:r.value,"onUpdate:value":a[2]||(a[2]=o=>r.value=o),disabled:e.disabled,onBlur:O,onPressEnter:O,allowClear:""},null,8,["value","disabled"])]),_:1})):(u(),g(V,{key:1},[e.input?(u(),T(B,{key:0,value:r.value,"onUpdate:value":a[3]||(a[3]=o=>r.value=o),disabled:e.disabled,onBlur:O,onPressEnter:O,allowClear:""},null,8,["value","disabled"])):x("",!0)],64)),e.type=="file"||e.input?(u(),g("span",{key:2,ref_key:"element",ref:d},[q(t.$slots,"default",{},()=>[C(n(W,null,{default:w(()=>[n(P,null,{icon:w(()=>[n(A)]),default:w(()=>[pe(" "+j(f(X)("Uploader.upload")),1)]),_:1}),!e.hideFinder&&e.finder?(u(),T(P,{key:0,onClick:a[4]||(a[4]=Q(o=>h.value=!0,["stop"]))},{icon:w(()=>[Ne]),_:1})):x("",!0)]),_:1},512),[[U,e.multiple&&(e.limit==0||l.value.length<e.limit)||l.value.length==0||e.onlyShow]])],!0)],512)):x("",!0)]),(e.type=="file"||e.input)&&!e.progress?(u(),g(V,{key:1},[C(n(K,{status:"active",percent:m.value},null,8,["percent"]),[[U,m.value>0]]),C(c("div",null,j(S.value),513),[[U,m.value>0]])],64)):x("",!0),e.type=="image"&&!e.input?(u(),g("div",Pe,[n(R,{value:l.value,"onUpdate:value":a[5]||(a[5]=o=>l.value=o)},null,8,["value"]),C(c("span",{ref_key:"element",ref:d},[q(t.$slots,"default",{},()=>[c("div",{class:"image-btn",style:Y({height:e.imageHeight+"px",width:e.imageWidth+"px"})},[C(n(K,{type:"circle",percent:m.value,width:e.imageHeight},{format:w(o=>[c("div",null,j(o)+"%",1),c("div",je,j(S.value),1)]),_:1},8,["percent","width"]),[[U,m.value>0]]),n(W,{direction:"vertical"},{default:w(()=>[ze,!e.hideFinder&&e.finder?(u(),g("i",{key:0,class:"far fa-folder-open",onClick:a[6]||(a[6]=Q(o=>h.value=!0,["stop"]))})):x("",!0)]),_:1})],4)],!0)],512),[[U,e.multiple&&(e.limit==0||l.value.length<e.limit)||l.value.length==0]])])):x("",!0),n(ie,{visible:h.value,"onUpdate:visible":a[8]||(a[8]=o=>h.value=o),width:"70%",title:f(X)("Uploader.finder"),onOk:a[9]||(a[9]=o=>h.value=!1)},{default:w(()=>[n(ae,null,{default:w(()=>[n(le,{data:e.finder,selection:l.value,"onUpdate:selection":a[7]||(a[7]=o=>l.value=o),"selection-limit":e.limit,"selection-type":e.multiple?"checkbox":"radio",scroll:p},null,8,["data","selection","selection-limit","selection-type"])]),_:1})]),_:1},8,["visible","title"])],42,Ce)}}});var Ct=H(Oe,[["__scopeId","data-v-7637d388"]]);export{Ct as default};
