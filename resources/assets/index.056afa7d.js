var xe=Object.defineProperty;var ve=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable;var Ce=(e,i,F)=>i in e?xe(e,i,{enumerable:!0,configurable:!0,writable:!0,value:F}):e[i]=F,Me=(e,i)=>{for(var F in i||(i={}))Ee.call(i,F)&&Ce(e,F,i[F]);if(ve)for(var F of ve(i))De.call(i,F)&&Ce(e,F,i[F]);return e};import{_ as Oe,s as g,w as ne,x as pe,f as ye}from"./index.0858f516.js";import{l as fe}from"./lodash.c9cf1bdb.js";import"./vue.db505ee4.js";import{d as $e}from"./vuedraggable.e7e6f001.js";import{d as Se,q as Ve,r as we,a as Ne,t as Ue,aW as p,aR as _,ar as k,bd as l,c as o,at as x,aV as J,S as C,ai as w,H as K,as as E,au as m,R as D,af as oe,ah as qe,U as Le,aT as ze,aS as Be}from"./@vue.cb43a243.js";import{M as Fe}from"./ant-design-vue.6b10f349.js";import"./js-md5.5179c6be.js";import"./@babel.6cd0804c.js";import"./regenerator-runtime.8e24db72.js";import"./vue-router.a08742b9.js";import"./js-cookie.31874410.js";import"./spark-md5.2cc5764b.js";import"./@vueuse.81e70e6d.js";import"./vue-demi.5fb18120.js";import"./axios.e3200588.js";import"./@ant-design.bcfb08ae.js";import"./@ctrl.fa7cbd46.js";/* empty css                     */import"./dayjs.38e390ea.js";import"./sortablejs.412b554c.js";import"./clipboard.099d05c9.js";import"./markdown-it.80c3a67b.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.c97a8414.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.86f7507c.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";const je=Se({name:"ExCurd",components:{draggable:$e},setup(){const e=Ve({tables:[],controller:[],controllerIndex:-1,newController:{table:"",title:"",name:""},newMethod:{title:"",name:"",type:""},method:[],methodIndex:-1,drawingMain:{component:null,ref:null},componentList:[],settingForm:null,settingFormVisible:!0,tableVisible:!1,tableModalRender:null,tableTreeNode:null,tableModalTitle:null,index:-1,database:null,isSave:!0,methodTypes:[{value:"grid",label:"\u6570\u636E\u8868\u683C(grid)"},{value:"form",label:"\u8868\u5355(form)"},{value:"detail",label:"\u8BE6\u60C5(detail)"}]}),i=we(),F=we();y(),addEventListener("keydown",le),addEventListener("keyup",Y),Ne(()=>{removeEventListener("keydown",le),removeEventListener("keyup",Y)});let Q=0,X=0;function le(t){t.keyCode==17&&(Q=1),t.keyCode==83&&(X=1),Q==1&&X==1&&W()}function Y(t){t.keyCode==17&&(Q=0),t.keyCode==83&&(X=0)}function Z(){A()}function y(){N(),U(),g("ex-admin/plugin-curd-controller-Index/getFormComponent").then(t=>{e.componentList=t.data})}function R(t){for(let n in t.content){let a=fe.exports.cloneDeep(t.content),r=[];a[n].forEach(u=>{r.push(u),R(u)}),["ExForm","ARow","ACol"].indexOf(t.name)>-1&&(t.content[n]=$(t.name,r,t))}}function M(t){return O(t,!0)}function O(t,n=!1){let a;return n?a=t.draggedContext.element.component.name:a=t.draggedContext.element.name,!(a=="ACol"&&t.relatedContext.component.$attrs.group.name!="ARow"||a!="ACol"&&t.relatedContext.component.$attrs.group.name=="ARow")}function $(t,n,a={}){let r="";return t=="ARow"?r="curd-children-row":t=="ACol"&&(r="curd-row-draggable"),[{name:"DraggableRender",attribute:{group:{name:t,put:!0,pull:!0},animation:1e3,chosenClass:"ex-drag-choose",list:n,tag:t=="ARow"?"render":"div",componentData:{data:a},class:r,style:{width:"100%"},move:u=>O(u)},event:{End:u=>{he()},Sort:u=>{e.drawingMain.ref.forceUpdate()},Choose:u=>{document.querySelectorAll("[data-choose]").forEach(f=>{f.removeAttribute("data-choose")}),u.item.setAttribute("data-choose",!0);let s=u.item.__draggable_context.element;s.name==="AFormItem"?e.settingForm=s.content.default[0].attribute.drawingForm:s.name=="DraggableRender"?e.settingForm=s.attribute.componentData.data.attribute.drawingForm:e.settingForm=s.attribute.drawingForm}}}]}const A=fe.exports.debounce(j,150);function q(t,n,a,r,u,s,f){t.forEach(v=>{if(v.name=="AFormItem"){if(v.attribute&&v.attribute.name.indexOf("default")>-1){let b=n[v.content.default[0].bindAttribute.value.replace(r+".","")];b===void 0&&(b=n[a[s]]),n[a[s]]=b,a.default=n[a[s]],v.content.default[0].bindAttribute.value=f,v.content.default[0].modelBind.value=f}else if(u.name==="ARangePicker"&&v.attribute.title==="\u9ED8\u8BA4\u503C"){n[a[s]]=n[v.content.default[0].bindAttribute.value.replace(r+".","")],a.default=n[a[s]],v.content.default[0].bindAttribute.value=f,v.content.default[0].modelBind.value=f;const b=u.attribute.startField;u.attribute.startField=r+"."+b.substr(b.indexOf(".")+1);const h=u.attribute.endField;u.attribute.endField=r+"."+h.substr(h.indexOf(".")+1)}}else v.content&&v.content.default&&q(v.content.default,n,a,r,u,s,f)})}function S(t){t.forEach(n=>{if(typeof n=="object"){if(n.name=="AFormItem"){const a=e.drawingMain.component,r=a.bindAttribute.model,u=a.bind[r];let s=n,f=s.content.default[0],v=f.attribute.drawingForm,b=v.bind[v.bindAttribute.model];for(let h in b)if(h=="title")s.attribute.label=b[h];else if(!(["name","default"].indexOf(h)>-1))if(h=="required")s.attribute.required=b[h];else if(h=="field"&&f.name!="ACascader"){let I=r+"."+b[h];f.bindAttribute[b.modelValue]=I,f.modelBind[b.modelValue]=I,s.attribute.name=[b[h]],q(v.content.default,u,b,r,f,h,I)}else if(["character","addonBefore","addonAfter","prefix","suffix"].indexOf(h)>-1&&b[h]){let I=Le(b[h]);Array.isArray(I)?f.content[h]=I:f.content[h]=[I]}else if(h==="config"){for(let I in b[h])I=="options"&&b[h].options_type==3&&(f.attribute.options=[],Object.assign(f.attribute.options,b[h][I]));if(f.name=="ExSelectTable"){let I="ex-admin/"+b[h].grid_class.replaceAll("\\","-")+"/"+b[h].grid_method,ge={};b[h].params.forEach(_e=>{ge[_e.var]=_e.value}),ne(f.attribute,"gridUrl",I),ne(f.attribute,"params",ge)}}else ne(f.attribute,h,b[h])}else if(n.name=="DraggableRender")n.attribute.key=pe(20),S(n.attribute.list);else if(n.name=="ARow"||n.name=="ACol"){let a=n.attribute.drawingForm,r=a.bind[a.bindAttribute.model];delete n.attribute.md,delete n.attribute.sm,delete n.attribute.xs;for(let u in r)ne(n.attribute,u,r[u])}n.content&&n.content.default&&S(n.content.default)}})}function j(){const t=e.drawingMain.component;let n=t.attribute.drawingForm,a=n.bind[n.bindAttribute.model];if(t.name=="ExForm")Object.assign(t.attribute,a),t.content.default||(t.content.default=[]),S(t.content.default);else if(t.name=="ExGrid"){const r=[];for(let u in a)u=="columns"?(a[u].forEach(s=>{r.push({dataIndex:s.field,title:s.label,type:s.form_type||"",header:{name:"html",attribute:{class:"ex_admin_table_th_name","data-tag":"span"},content:{default:[s.label]}}})}),a.switch.indexOf("hideAction")==-1&&r.push({dataIndex:"ExAdminAction",title:"",header:{name:"html",attribute:{class:"ex_admin_table_th_name","data-tag":"span"},content:{default:[""]}}}),t.attribute.columns=r):u=="switch"?a.swtichOptions.forEach(s=>{t.attribute[s]=a[u].indexOf(s)>-1}):t.attribute[u]=a[u]}else if(t.name=="ADescriptions")for(let r in a)if(r=="items"){const u=[];a[r].forEach(s=>{var f;u.push({name:"ADescriptionsItem",attribute:{title:s.label,span:s.span},content:{default:[(f=t.attribute.data[s.field])!=null?f:"--"],label:[s.label]}})}),t.content.default=u}else t.attribute[r]=a[r];e.drawingMain.ref.forceUpdate(),e.isSave=!1}function V(t,n){t.forEach(a=>{let r;if(typeof a=="object"){if(a.name=="AFormItem"){const u=e.drawingMain.component;let s=a.content.default[0].attribute.drawingForm,f=s.bindAttribute.model;ye(s.bind[f],s.attribute.exceptField||[]);const v=u.bindAttribute.model,b=u.bind[v];s.bind[f].default=b[s.bind[f].field],n.push(s.bind[f]),r=s.bind[f]}else if(a.name=="DraggableRender")V(a.attribute.list,n);else if(a.name=="ARow"||a.name=="ACol"){let u=a.attribute.drawingForm,s=u.bindAttribute.model;ye(u.bind[s],u.attribute.exceptField||[]),n.push(u.bind[s]),r=u.bind[s]}a.content&&a.content.default&&r&&(r.content=[],V(a.content.default,r.content))}})}function W(){A(),setTimeout(()=>{let t={};const n=e.drawingMain.component;let a=n.attribute.drawingForm.bindAttribute.model;t.config=n.attribute.drawingForm.bind[a],n.name=="ExForm"?(t.type="form",t.component=[],V(n.content.default,t.component)):n.name=="ExGrid"?t.type="grid":n.name=="ADescriptions"&&(t.type="detail"),g({url:"ex-admin/plugin-curd-controller-Index/save",method:"post",data:{id:e.method[e.methodIndex].id,controller:e.controller[e.controllerIndex].name,class:e.controller[e.controllerIndex].class,function:e.method[e.methodIndex].name,setting:t}}).then(r=>{c(e.methodIndex,!1),e.isSave=!0})},500)}function P(t){e.drawingMain.ref=t}function N(){g("ex-admin/plugin-curd-controller-Index/getController").then(t=>{e.controller=t.data})}function U(){g("ex-admin/plugin-curd-controller-Database/getTable").then(t=>{e.tables=t.data.map(n=>(n.tableName=n.name,n.dataRef=n,n.name=n.id,n.children=[],n.class="table-tree-node",n))})}function G(t){if(e.tableVisible=!1,!t){U();return}return new Promise(n=>{g("ex-admin/plugin-curd-controller-Database/getTableColumn?table="+t.dataRef.id).then(a=>{t.dataRef.children=a.data.map(r=>(r.id=t.id+r.field,r.name=r.field,r.table=t.id,r.parent=t,r.isLeaf=!0,r)),e.tables=[...e.tables],n()})})}function z(t){Fe.confirm({title:"\u5220\u9664\u8868",content:"\u786E\u8BA4\u5220\u9664\u8868\uFF0C\u4E0D\u53EF\u6062\u590D\uFF1F",onOk(){g.delete("/ex-admin/plugin-curd-controller-Database/grid",{data:{ex_admin_action:"delete",ex_admin_sidebar:!0,ids:[t]}}).then(n=>{U()})}})}function L(t,n,a){Fe.confirm({title:"\u5220\u9664\u8868\u5B57\u6BB5",content:"\u786E\u8BA4\u5220\u9664\u8868\u5B57\u6BB5\uFF0C\u4E0D\u53EF\u6062\u590D\uFF1F",onOk(){g.delete("/ex-admin/plugin-curd-controller-Database/grid",{data:{ex_admin_action:"delete",ex_admin_trashed:"false",table:t,ids:[n]}}).then(r=>{G(a)})}})}function ae(t,n,a){e.tableTreeNode=a,e.tableModalTitle="\u7F16\u8F91\u5B57\u6BB5",e.tableModalRender=null,g.put("/ex-admin/plugin-curd-controller-Database/form",{table:t,field:n}).then(r=>{e.tableVisible=!0,e.tableModalRender=r,e.tableModalRender.footer=r.content.footer[0],delete e.tableModalRender.content.footer})}function ee(){e.tableTreeNode=null,e.tableModalTitle="\u6DFB\u52A0\u8868",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/tableForm").then(t=>{e.tableVisible=!0,e.tableModalRender=t,e.tableModalRender.footer=t.content.footer[0],delete e.tableModalRender.content.footer})}function de(){e.tableTreeNode=null,e.tableModalTitle="\u8868\u9884\u8BBE\u5B57\u6BB5",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/presetFields").then(t=>{e.tableVisible=!0,e.tableModalRender=t,e.tableModalRender.footer=t.content.footer[0],delete e.tableModalRender.content.footer})}function re(t){e.tableTreeNode=null,e.tableModalTitle="\u7F16\u8F91\u8868",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/tableForm",{id:t}).then(n=>{e.tableVisible=!0,e.tableModalRender=n,e.tableModalRender.footer=n.content.footer[0],delete e.tableModalRender.content.footer})}function ie(t){e.tableModalTitle="\u5173\u8054\u8868(\u6A21\u578B)",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/modelRelationForm",{table:t}).then(n=>{e.tableVisible=!0,e.tableModalRender=n,e.tableModalRender.footer=n.content.footer[0],delete e.tableModalRender.content.footer})}function se(t){e.tableModalTitle="\u6DFB\u52A0\u8868\u5B57\u6BB5",e.tableModalRender=null,g.post("/ex-admin/plugin-curd-controller-Database/form",{table:t}).then(n=>{e.tableVisible=!0,e.tableModalRender=n,e.tableModalRender.footer=n.content.footer[0],delete e.tableModalRender.content.footer})}function H(t){e.methodIndex=-1,g({url:"ex-admin/plugin-curd-controller-Index/getMethod",method:"post",data:{id:t}}).then(n=>{e.method=n.data})}function ue(){g({url:"ex-admin/plugin-curd-controller-Index/deleteMethod",method:"post",data:{class:e.controller[e.controllerIndex].class,controller:e.controller[e.controllerIndex].name,method:e.method[e.methodIndex].name,id:e.method[e.methodIndex].id}}).then(t=>{e.methodIndex=-1,e.method.splice(e.methodIndex,1)})}function B(){const t=e.controller[e.controllerIndex].class,n=e.method[e.methodIndex];g({url:"ex-admin/plugin-curd-controller-Index/updateMethod",method:"post",data:{controller:t,id:n.id,name:n.name,title:n.title,updateTitle:n.updateTitle,updateName:n.updateName}}).then(a=>{e.method[e.methodIndex].title=n.updateTitle,e.method[e.methodIndex].name=n.updateName})}function te(t,n,a){g({url:"ex-admin/plugin-curd-controller-Index/createController",method:"post",data:{name:n,title:t,table:a}}).then(r=>{e.newController.title="",e.newController.table="",e.newController.name="",N()})}function ce(t,n,a){g({url:"ex-admin/plugin-curd-controller-Index/createMethod",method:"post",data:{controller_id:e.controller[e.controllerIndex].id,class:e.controller[e.controllerIndex].class,controller:e.controller[e.controllerIndex].name,table:e.controller[e.controllerIndex].table,name:n,type:a,title:t}}).then(r=>{e.newMethod.title="",e.newMethod.name="",e.newMethod.type="",e.method.push({name:n,title:t,updateTitle:t,updateName:n}),g({url:"ex-admin/plugin-curd-controller-Index/createMethodInit",method:"post",data:{class:e.controller[e.controllerIndex].class,name:n,type:a}}).then(u=>{H(e.controller[e.controllerIndex].id)})})}function me(){const t=e.controller[e.controllerIndex];g({url:"ex-admin/plugin-curd-controller-Index/updateController",method:"post",data:{id:t.id,path:t.path,class:t.class,title:t.title,updateName:t.name}}).then(n=>{N()})}function d(){const t=e.controller[e.controllerIndex];g({url:"ex-admin/plugin-curd-controller-Index/deleteController",method:"post",data:{id:t.id,path:t.path}}).then(n=>{e.controllerIndex=-1,N(),e.method=[]})}function c(t,n=!0){e.methodIndex=t,e.settingForm=null,g({url:"ex-admin/plugin-curd-controller-Index/render",method:"post",data:{class:e.controller[e.controllerIndex].class,function:e.method[e.methodIndex].name,var:[]}}).then(a=>{e.isSave=!0,R(a.data),e.drawingMain.component=a.data})}function T(t,n){n.mouseenter=!0,e.tableTreeNode=n,e.tables=[...e.tables]}function Ie(t,n){n.mouseenter=!1,e.tables=[...e.tables]}function ke(t){t.newIndex!==t.oldIndex&&g.post("ex-admin/plugin-curd-controller-Database/sortField",{table:t.item.__draggable_context.element.table,field:t.item.__draggable_context.element.field,sort:t.newIndex})}function Re(t){if(!t.component)return!1;let n=fe.exports.cloneDeep(t.component);if(n.name=="AFormItem"){let a=n.content.default[0].attribute.drawingForm,r=a.bind[a.bindAttribute.model];a.attribute.key=pe(20),r.field||(r.field=pe(20)),n.attribute.validateFormField=e.drawingMain.component.bindAttribute.validateField}if(n.name=="ARow"){let a=[],r=[];n.content.default[0].content={default:$("ACol",r)},a=n.content.default,n.content={default:$(n.name,a,n)}}else if(n.name=="ACol"){let a=[];n.content={default:$(n.name,a,n)}}return n}function he(t){j()}function Te(t){return!(!t.relatedContext.element.table&&!t.draggedContext.element.component)}function Ae(t){e.newController.name=t}return Me({changeTable:Ae,onFieldMove:Te,onMove:O,onCloneMove:M,onEnd:he,onClone:Re,relationTable:ie,onFieldSort:ke,addTable:ee,presetFields:de,editTableField:ae,editTable:re,deleteTable:z,addTableField:se,tableMouseLeave:Ie,tableMouseenter:T,onLoadTable:G,deleteTableField:L,getController:N,watchModel:Z,dragSave:W,getRender:c,getMethod:H,deleteMethod:ue,updateMethod:B,createController:te,createMethod:ce,updateController:me,deleteController:d,dragRef:i,drawingRef:F,setRef:P},Ue(e))}}),be=e=>(ze("data-v-5747349a"),e=e(),Be(),e),We=C("\u4FDD\u5B58 "),Pe=C(" \u6DFB\u52A0 "),Ge=C(" \u4FDD\u5B58 "),He=C(" \u7F16\u8F91 "),Je=C(" \u5220\u9664 "),Ke={class:"flex-column"},Qe={class:"title"},Xe=be(()=>m("span",null,"\u63A7\u5236\u5668",-1)),Ye={class:"flex-1-auto"},Ze=["onContextmenu","onClick"],et={class:"name"},tt={class:"desc"},nt=C(" \u4FDD\u5B58 "),ot=C(" \u6DFB\u52A0 "),lt=C(" \u4FDD\u5B58 "),at=C(" \u7F16\u8F91 "),dt=C(" \u5220\u9664 "),rt={class:"flex-column"},it={class:"title"},st=be(()=>m("span",null,"\u65B9\u6CD5",-1)),ut={class:"flex-1-auto"},ct=["onContextmenu","onClick"],mt={class:"name"},pt={class:"desc"},ft={class:"flex-column"},bt=C("\u6DFB\u52A0\u8868"),ht=C("\u8868\u9884\u8BBE\u5B57\u6BB5"),gt=["onMouseenter","onMouseleave"],_t={class:"table-tree-title"},vt=["title"],Ct={key:0,class:"table-tree-action-table"},Mt=["title"],yt=["onMouseenter","onMouseleave"],wt={class:"table-tree-title"},Ft=["title"],It={key:0,class:"table-tree-action"},kt=["title"],Rt={class:"components"},Tt={style:{display:"flex","align-items":"center",margin:"5px"}},At=be(()=>m("i",{class:"fas fa-layer-group"},null,-1)),xt={style:{"margin-left":"5px"}},Et={class:"components-draggable"},Dt={class:"components-item"},Ot={class:"components-body"},$t={class:"header"},St=C("(ctrl+s)"),Vt={class:"drawing scrollbar",ref:"drawingRef"};function Nt(e,i,F,Q,X,le){const Y=p("a-select-option"),Z=p("a-select"),y=p("a-form-item"),R=p("a-input"),M=p("a-button"),O=p("a-form"),$=p("PlusOutlined"),A=p("a-menu-item"),q=p("a-popover"),S=p("EditOutlined"),j=p("question-circle-outlined"),V=p("DeleteOutlined"),W=p("a-popconfirm"),P=p("a-menu"),N=p("ReloadOutlined"),U=p("a-tooltip"),G=p("a-dropdown"),z=p("a-layout-sider"),L=p("render"),ae=p("a-modal"),ee=p("a-space"),de=p("FolderOutlined"),re=p("reload-outlined"),ie=p("NodeIndexOutlined"),se=p("FileOutlined"),H=p("draggable"),ue=p("a-sub-menu"),B=p("a-tab-pane"),te=p("a-tabs"),ce=p("a-layout-content"),me=p("a-layout");return _(),k(me,{class:"layout"},{default:l(()=>[o(z,{width:130,class:"controller scrollbar"},{default:l(()=>[o(G,{trigger:["contextmenu"]},{overlay:l(()=>[o(P,null,{default:l(()=>[o(q,{trigger:"click",placement:"right"},{content:l(()=>[o(O,{"label-col":{span:7},model:e.newController,onFinish:i[3]||(i[3]=d=>e.createController(e.newController.title,e.newController.name,e.newController.table))},{default:l(()=>[o(y,{label:"\u6570\u636E\u8868",name:"table",required:""},{default:l(()=>[o(Z,{value:e.newController.table,"onUpdate:value":i[0]||(i[0]=d=>e.newController.table=d),onChange:e.changeTable,"dropdown-match-select-width":400,showSearch:""},{default:l(()=>[(_(!0),x(K,null,J(e.tables,d=>(_(),k(Y,{value:d.id},{default:l(()=>[C(w(d.tableName),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value","onChange"])]),_:1}),o(y,{label:"\u6807\u9898",name:"title",required:""},{default:l(()=>[o(R,{value:e.newController.title,"onUpdate:value":i[1]||(i[1]=d=>e.newController.title=d)},null,8,["value"])]),_:1}),o(y,{label:"\u540D\u79F0",name:"name",required:""},{default:l(()=>[o(R,{value:e.newController.name,"onUpdate:value":i[2]||(i[2]=d=>e.newController.name=d)},null,8,["value"])]),_:1}),o(y,{"wrapper-col":{offset:6},style:{"margin-bottom":"5px"}},{default:l(()=>[o(M,{type:"primary","html-type":"submit"},{default:l(()=>[We]),_:1})]),_:1})]),_:1},8,["model"])]),default:l(()=>[o(A,null,{icon:l(()=>[o($)]),default:l(()=>[Pe]),_:1})]),_:1}),e.controllerIndex>-1?(_(),k(q,{key:0,trigger:"click",placement:"right"},{content:l(()=>[o(O,{"label-col":{span:6},model:e.controller[e.controllerIndex],onFinish:e.updateController},{default:l(()=>[o(y,{name:"title",label:"\u6807\u9898",required:""},{default:l(()=>[o(R,{value:e.controller[e.controllerIndex].title,"onUpdate:value":i[4]||(i[4]=d=>e.controller[e.controllerIndex].title=d)},null,8,["value"])]),_:1}),o(y,{name:"name",label:"\u540D\u79F0",required:""},{default:l(()=>[o(R,{value:e.controller[e.controllerIndex].name,"onUpdate:value":i[5]||(i[5]=d=>e.controller[e.controllerIndex].name=d)},null,8,["value"])]),_:1}),o(y,{"wrapper-col":{offset:6},style:{"margin-bottom":"5px"}},{default:l(()=>[o(M,{type:"primary","html-type":"submit"},{default:l(()=>[Ge]),_:1})]),_:1})]),_:1},8,["model","onFinish"])]),default:l(()=>[o(A,null,{icon:l(()=>[o(S)]),default:l(()=>[He]),_:1})]),_:1})):E("",!0),e.controllerIndex>-1?(_(),k(W,{key:1,title:"\u786E\u8BA4\u5220\u9664\uFF1F",onConfirm:i[6]||(i[6]=d=>e.deleteController())},{icon:l(()=>[o(j,{style:{color:"red"}})]),default:l(()=>[o(A,null,{icon:l(()=>[o(V)]),default:l(()=>[Je]),_:1})]),_:1})):E("",!0)]),_:1})]),default:l(()=>[m("div",Ke,[m("div",Qe,[Xe,o(M,{size:"small",shape:"circle",onClick:e.getController},{icon:l(()=>[o(N)]),_:1},8,["onClick"])]),m("ul",Ye,[(_(!0),x(K,null,J(e.controller,(d,c)=>(_(),x("li",{key:c,onContextmenu:D(T=>e.controllerIndex=c,["prevent"]),onClick:T=>{e.controllerIndex=c,e.getMethod(d.id)},class:oe(e.controllerIndex==c?"active":"")},[o(U,{placement:"bottom",mouseEnterDelay:1},{title:l(()=>[C(w(d.title),1)]),default:l(()=>[m("div",et,w(d.title),1)]),_:2},1024),o(U,{placement:"bottom",mouseEnterDelay:1},{title:l(()=>[C(w(d.path),1)]),default:l(()=>[m("div",tt,w(d.name),1)]),_:2},1024)],42,Ze))),128))])])]),_:1})]),_:1}),o(z,{width:130,class:"controller scrollbar"},{default:l(()=>[o(G,{trigger:["contextmenu"]},{overlay:l(()=>[o(P,null,{default:l(()=>[o(q,{trigger:"click",placement:"right"},{content:l(()=>[o(O,{"label-col":{span:6},model:e.newMethod,onFinish:i[10]||(i[10]=d=>e.createMethod(e.newMethod.title,e.newMethod.name,e.newMethod.type))},{default:l(()=>[o(y,{label:"\u7C7B\u578B",name:"type",required:""},{default:l(()=>[o(Z,{value:e.newMethod.type,"onUpdate:value":i[7]||(i[7]=d=>e.newMethod.type=d),options:e.methodTypes},null,8,["value","options"])]),_:1}),o(y,{label:"\u6807\u9898",name:"title",required:""},{default:l(()=>[o(R,{value:e.newMethod.title,"onUpdate:value":i[8]||(i[8]=d=>e.newMethod.title=d)},null,8,["value"])]),_:1}),o(y,{label:"\u540D\u79F0",name:"name",required:""},{default:l(()=>[o(R,{value:e.newMethod.name,"onUpdate:value":i[9]||(i[9]=d=>e.newMethod.name=d)},null,8,["value"])]),_:1}),o(y,{"wrapper-col":{offset:6},style:{"margin-bottom":"5px"}},{default:l(()=>[o(M,{type:"primary","html-type":"submit"},{default:l(()=>[nt]),_:1})]),_:1})]),_:1},8,["model"])]),default:l(()=>[o(A,null,{icon:l(()=>[o($)]),default:l(()=>[ot]),_:1})]),_:1}),e.methodIndex>-1?(_(),k(q,{key:0,trigger:"click",placement:"right"},{content:l(()=>[o(O,{"label-col":{span:6},model:e.method[e.methodIndex],onFinish:e.updateMethod},{default:l(()=>[o(y,{name:"updateTitle",label:"\u6807\u9898",required:""},{default:l(()=>[o(R,{value:e.method[e.methodIndex].updateTitle,"onUpdate:value":i[11]||(i[11]=d=>e.method[e.methodIndex].updateTitle=d)},null,8,["value"])]),_:1}),o(y,{name:"updateName",label:"\u540D\u79F0",required:""},{default:l(()=>[o(R,{value:e.method[e.methodIndex].updateName,"onUpdate:value":i[12]||(i[12]=d=>e.method[e.methodIndex].updateName=d)},null,8,["value"])]),_:1}),o(y,{"wrapper-col":{offset:6},style:{"margin-bottom":"5px"}},{default:l(()=>[o(M,{type:"primary","html-type":"submit"},{default:l(()=>[lt]),_:1})]),_:1})]),_:1},8,["model","onFinish"])]),default:l(()=>[o(A,null,{icon:l(()=>[o(S)]),default:l(()=>[at]),_:1})]),_:1})):E("",!0),e.methodIndex>-1?(_(),k(W,{key:1,title:"\u786E\u8BA4\u5220\u9664\uFF1F",onConfirm:i[13]||(i[13]=d=>e.deleteMethod())},{icon:l(()=>[o(j,{style:{color:"red"}})]),default:l(()=>[o(A,null,{icon:l(()=>[o(V)]),default:l(()=>[dt]),_:1})]),_:1})):E("",!0)]),_:1})]),default:l(()=>[m("div",rt,[m("div",it,[st,o(M,{size:"small",shape:"circle",onClick:i[14]||(i[14]=d=>e.getMethod(e.controller[e.controllerIndex].id))},{icon:l(()=>[o(N)]),_:1})]),m("ul",ut,[(_(!0),x(K,null,J(e.method,(d,c)=>(_(),x("li",{key:c,onContextmenu:D(T=>e.methodIndex=c,["prevent"]),onClick:T=>e.getRender(c),class:oe(e.methodIndex==c?"active":"")},[o(U,{placement:"bottom",mouseEnterDelay:1},{title:l(()=>[C(w(d.title),1)]),default:l(()=>[m("div",mt,w(d.title),1)]),_:2},1024),o(U,{placement:"bottom",mouseEnterDelay:1},{title:l(()=>[C(w(d.name),1)]),default:l(()=>[m("div",pt,w(d.name),1)]),_:2},1024)],42,ct))),128))])])]),_:1})]),_:1}),o(z,{width:300,class:"scrollbar",ref:"dragRef"},{default:l(()=>[o(te,{type:"card",class:"curd-tabs"},{default:l(()=>[o(B,{key:"1",tab:"\u6570\u636E\u5E93",style:{height:"100%"}},{default:l(()=>[o(ae,{visible:e.tableVisible,"onUpdate:visible":i[16]||(i[16]=d=>e.tableVisible=d),title:e.tableModalTitle,width:"1000px"},{footer:l(()=>[e.tableModalRender?(_(),k(L,{key:0,data:e.tableModalRender.footer},null,8,["data"])):E("",!0)]),default:l(()=>[o(L,{data:e.tableModalRender,onSuccess:i[15]||(i[15]=d=>e.onLoadTable(e.tableTreeNode))},null,8,["data"])]),_:1},8,["visible","title"]),m("div",ft,[o(ee,{style:{margin:"0 10px 10px 10px"}},{default:l(()=>[o(M,{onClick:e.addTable},{default:l(()=>[bt]),_:1},8,["onClick"]),o(M,{onClick:e.presetFields},{default:l(()=>[ht]),_:1},8,["onClick"])]),_:1}),o(P,{mode:"inline",class:"curd-table-tree",selectable:!1},{default:l(()=>[(_(!0),x(K,null,J(e.tables,d=>(_(),k(ue,{key:d.id,onTitleClick:c=>e.onLoadTable(d)},{title:l(()=>[m("div",{onMouseenter:c=>e.tableMouseenter(c,d),onMouseleave:c=>e.tableMouseLeave(c,d)},[m("div",_t,[o(de),m("div",{class:"field-title",title:d.name},w(d.name),9,vt),d.mouseenter?(_(),x("div",Ct,[o(M,{shape:"circle",size:"small",onClick:D(c=>e.onLoadTable(d),["stop"])},{icon:l(()=>[o(re)]),_:2},1032,["onClick"]),o(M,{shape:"circle",size:"small",onClick:D(c=>e.addTableField(d.id),["stop"])},{icon:l(()=>[o($)]),_:2},1032,["onClick"]),o(M,{shape:"circle",size:"small",onClick:D(c=>e.editTable(d.id),["stop"])},{icon:l(()=>[o(S)]),_:2},1032,["onClick"]),o(M,{shape:"circle",size:"small",onClick:D(c=>e.relationTable(d.id),["stop"])},{icon:l(()=>[o(ie)]),_:2},1032,["onClick"]),o(M,{shape:"circle",size:"small",onClick:D(c=>e.deleteTable(d.id),["stop"])},{icon:l(()=>[o(V)]),_:2},1032,["onClick"])])):E("",!0)]),m("div",{class:"field-title-desc",title:d.comment},w(d.comment),9,Mt)],40,gt)]),default:l(()=>[o(H,{style:{width:"100%"},list:d.children,onSort:e.onFieldSort,clone:e.onClone,move:e.onFieldMove,onEnd:e.onEnd,group:{pull:"clone",put:!1},"item-key":"id"},{item:l(({element:c})=>[m("div",{onMouseenter:T=>e.tableMouseenter(T,c),onMouseleave:T=>e.tableMouseLeave(T,c)},[(_(),k(A,{key:c.id},{default:l(()=>[m("div",wt,[o(se),m("div",{class:"field-title",title:c.name},w(c.name),9,Ft),c.mouseenter?(_(),x("div",It,[o(M,{shape:"circle",size:"small",onClick:D(T=>e.editTableField(d.id,c.field,d),["stop"])},{icon:l(()=>[o(S)]),_:2},1032,["onClick"]),o(M,{shape:"circle",size:"small",onClick:D(T=>e.deleteTableField(d.id,c.field,d),["stop"])},{icon:l(()=>[o(V)]),_:2},1032,["onClick"])])):E("",!0)]),m("div",{class:"field-title-desc",title:c.comment},w(c.comment),9,kt)]),_:2},1024))],40,yt)]),_:2},1032,["list","onSort","clone","move","onEnd"])]),_:2},1032,["onTitleClick"]))),128))]),_:1})])]),_:1}),o(B,{key:"2",tab:"\u8868\u5355\u8BBE\u8BA1",forceRender:""},{default:l(()=>[(_(!0),x(K,null,J(e.componentList,d=>(_(),x("div",Rt,[m("div",Tt,[At,m("div",xt,w(d.label),1)]),m("div",Et,[o(H,{list:d.options,sort:!1,clone:e.onClone,onEnd:e.onEnd,move:e.onCloneMove,"chosen-class":"chosen-class",group:{name:"components",pull:"clone",put:!1}},{item:l(({element:c})=>[m("div",Dt,[m("div",Ot,[m("i",{class:oe(c.icon)},null,2),C(" "+w(c.label),1)])])]),_:2},1032,["list","clone","onEnd","move"])])]))),256))]),_:1})]),_:1})]),_:1},512),o(ce,{class:"main"},{default:l(()=>[m("div",$t,[o(ee,null,{default:l(()=>[o(M,{onClick:e.dragSave},{default:l(()=>[m("span",{style:qe(e.isSave?"":"color: red;")},"\u4FDD\u5B58",4),St]),_:1},8,["onClick"])]),_:1})]),m("div",Vt,[o(L,{ref:d=>e.setRef(d),data:e.drawingMain.component},null,8,["data"])],512)]),_:1}),m("div",{class:"collapse",onClick:i[17]||(i[17]=d=>e.settingFormVisible=!e.settingFormVisible)},[m("i",{class:oe(e.settingFormVisible?"fas fa-angle-double-right":"fas fa-angle-double-left")},null,2)]),e.settingFormVisible?(_(),k(z,{key:0,width:360,class:"settingForm scrollbar"},{default:l(()=>[o(te,{type:"card",class:"curd-tabs"},{default:l(()=>[e.settingForm?(_(),k(B,{key:"1",tab:"\u7EC4\u4EF6\u5C5E\u6027"},{default:l(()=>[o(L,{data:e.settingForm,onWatchModel:e.watchModel},null,8,["data","onWatchModel"])]),_:1})):E("",!0),o(B,{key:"2",tab:"\u5C5E\u6027",forceRender:""},{default:l(()=>[e.drawingMain.component?(_(),k(L,{key:0,data:e.drawingMain.component.attribute.drawingForm,onWatchModel:e.watchModel},null,8,["data","onWatchModel"])):E("",!0)]),_:1})]),_:1})]),_:1})):E("",!0)]),_:1})}var Tn=Oe(je,[["render",Nt],["__scopeId","data-v-5747349a"]]);export{Tn as default};
