var De=Object.defineProperty;var pe=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var he=(o,h,R)=>h in o?De(o,h,{enumerable:!0,configurable:!0,writable:!0,value:R}):o[h]=R,_e=(o,h)=>{for(var R in h||(h={}))Oe.call(h,R)&&he(o,R,h[R]);if(pe)for(var R of pe(h))Ve.call(h,R)&&he(o,R,h[R]);return o};import{_ as Le,a as $e,s as F,w as K,x as ie,f as ge}from"./index.e1b96d4a.js";import{l as J}from"./lodash.c9cf1bdb.js";import"./vue.db505ee4.js";import{d as Se}from"./vuedraggable.e7e6f001.js";import{d as ze,q as Ne,r as ve,a as Be,p as Pe,n as Ue,t as qe,aW as _,aR as v,ar as w,bd as i,c as a,as as E,au as f,at as D,aV as Q,R as O,af as oe,S as x,ai as k,H as X,ah as We,U as je,aT as Ge,aS as He}from"./@vue.cb43a243.js";import{m as Ke,M as Fe}from"./ant-design-vue.6b10f349.js";import"./js-md5.5179c6be.js";import"./@babel.6cd0804c.js";import"./regenerator-runtime.8e24db72.js";import"./vue-router.a08742b9.js";import"./js-cookie.31874410.js";import"./spark-md5.2cc5764b.js";import"./@vueuse.81e70e6d.js";import"./vue-demi.5fb18120.js";import"./axios.e3200588.js";import"./@ant-design.bcfb08ae.js";import"./@ctrl.fa7cbd46.js";/* empty css                     */import"./dayjs.38e390ea.js";import"./sortablejs.412b554c.js";import"./clipboard.099d05c9.js";import"./markdown-it.80c3a67b.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.c97a8414.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.86f7507c.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";const Je=ze({name:"ExCurd",components:{draggable:Se},setup(o,h){const R=$e(),e=Ne({tables:[],searchTable:"",controller:[],controllerIndex:-1,method:[],methodIndex:-1,drawingMain:{component:null,ref:null},componentList:[],controllerForm:null,controllerEditForm:null,methodForm:null,methodEditForm:null,settingForm:null,settingFormList:[],settingFormVisible:!0,tableVisible:!1,tableModalRender:null,tableTreeNode:null,tableModalTitle:null,index:-1,database:null,isSave:!0,methodTypes:[{value:"grid",label:"\u6570\u636E\u8868\u683C(grid)"},{value:"form",label:"\u8868\u5355(form)"},{value:"detail",label:"\u8BE6\u60C5(detail)"}]}),se=ve(),ce=ve();Y(),addEventListener("keydown",V),addEventListener("keyup",U),Be(()=>{removeEventListener("keydown",V),removeEventListener("keyup",U)});const P=Pe(()=>e.tables.filter(t=>t.name.indexOf(e.searchTable)>-1||t.comment.indexOf(e.searchTable)>-1));let C=0,I=0;function V(t){t.keyCode==17&&(C=1),t.keyCode==83&&(I=1),C==1&&I==1&&ee()}function U(t){t.keyCode==17&&(C=0),t.keyCode==83&&(I=0)}function S(){q()}function Y(){H(),$(),F("ex-admin/plugin-curd-controller-Index/getFormComponent").then(t=>{e.componentList=t.data})}function z(t){["ExForm","ARow","ACol","ExFormMany","ATabPane"].indexOf(t.name)>-1&&!t.content.default&&(t.content.default=[]);for(let n in t.content){let l=t.content,d=[];l[n].forEach(s=>{d.push(s),z(s)}),["ExForm","ARow","ACol","ExFormMany","ATabPane"].indexOf(t.name)>-1&&(n=="default"?t.content[n]=A(t.name,d,t):t.content[n]=d)}}function Z(t){return M(t,!0)}function M(t,n=!1){let l;return n?l=t.draggedContext.element.component.name:l=t.draggedContext.element.name,!(l=="ACol"&&t.relatedContext.component.$attrs.group.name!="ARow"||l!="ACol"&&t.relatedContext.component.$attrs.group.name=="ARow")}function A(t,n,l={}){let d="ex-drag-container";return t=="ARow"?d+=" curd-children-row":t=="ACol"&&(d+=" curd-row-draggable"),[{name:"DraggableRender",attribute:{group:{name:t,put:!0,pull:!0},animation:1e3,chosenClass:"ex-drag-choose",list:n,tag:t=="ARow"?"render":"div",componentData:{data:l},class:d,style:{width:"100%",minHeight:"32px"},move:s=>M(s)},event:{End:s=>{me()},Sort:s=>{e.drawingMain.ref.forceUpdate()},Choose:s=>{document.querySelectorAll("[data-choose]").forEach(u=>{u.removeAttribute("data-choose")}),s.item.setAttribute("data-choose",!0);let r=s.item.__draggable_context.element;r.name==="AFormItem"?e.settingForm=r.content.default[0].attribute.drawingForm:r.name=="DraggableRender"?e.settingForm=r.attribute.componentData.data.attribute.drawingForm:e.settingForm=r.attribute.drawingForm}}}]}const q=J.exports.debounce(j,150);function L(t,n,l,d,s,r,u){t.forEach(g=>{if(g.name=="AFormItem"){if(g.attribute&&g.attribute.name.indexOf("default")>-1){let p=n[g.content.default[0].bindAttribute.value.replace(d+".","")];p===void 0&&(p=n[l[r]]),n[l[r]]=p,l.default=n[l[r]],g.content.default[0].bindAttribute.value=u,g.content.default[0].modelBind.value=u}else if(s.name==="ARangePicker"&&g.attribute.title==="\u9ED8\u8BA4\u503C"){n[l[r]]=n[g.content.default[0].bindAttribute.value.replace(d+".","")],l.default=n[l[r]],g.content.default[0].bindAttribute.value=u,g.content.default[0].modelBind.value=u;const p=s.attribute.startField;s.attribute.startField=d+"."+p.substr(p.indexOf(".")+1);const m=s.attribute.endField;s.attribute.endField=d+"."+m.substr(m.indexOf(".")+1)}}else g.content&&g.content.default&&L(g.content.default,n,l,d,s,r,u)})}function W(t){t.forEach(n=>{if(typeof n=="object"){if(n.name=="AFormItem"){const l=e.drawingMain.component,d=l.bindAttribute.model,s=l.bind[d];let r=n,u=r.content.default[0],g=u.attribute.drawingForm,p=g.bind[g.bindAttribute.model];for(let m in p)if(m=="title"&&u.name!="ExFormMany")r.attribute.label=p[m];else if(!(["name","default"].indexOf(m)>-1))if(m=="required")r.attribute.required=p[m];else if(m=="field"&&u.name!="ACascader"){let y=d+"."+p[m];u.bindAttribute[p.modelValue]=y,u.modelBind[p.modelValue]=y,r.attribute.name=[p[m]],u.name=="ExFormMany"&&s[p[m]]===void 0&&(s[p[m]]=p.default),L(g.content.default,s,p,d,u,m,y)}else if(["character","addonBefore","addonAfter","prefix","suffix"].indexOf(m)>-1&&p[m]){let y=je(p[m]);Array.isArray(y)?u.content[m]=y:u.content[m]=[y]}else if(m==="config"){for(let y in p[m])y=="options"&&p[m].options_type==3&&(u.attribute.options=[],Object.assign(u.attribute.options,p[m][y]));if(u.name=="ExSelectTable"){let y="ex-admin/"+p[m].grid_class.replaceAll("\\","-")+"/"+p[m].grid_method,fe={};p[m].params.forEach(be=>{fe[be.var]=be.value}),K(u.attribute,"gridUrl",y),K(u.attribute,"params",fe)}}else K(u.attribute,m,p[m])}else if(n.name=="DraggableRender")n.attribute.key=ie(20),W(n.attribute.list);else if(n.name=="ARow"||n.name=="ACol"){let l=n.attribute.drawingForm,d=l.bind[l.bindAttribute.model];delete n.attribute.md,delete n.attribute.sm,delete n.attribute.xs;for(let s in d)K(n.attribute,s,d[s])}else if(n.name=="ATabs"){let l=n.attribute.drawingForm,d=l.bind[l.bindAttribute.model],s=[],r;d.pane.forEach((g,p)=>{let m=n.content.default[p];if(m)r=m;else{let y=[];m=J.exports.cloneDeep(r),m.attribute.key=p+1,m.content={default:A("ATabPane",y,m)}}m.attribute.tab=g.title,s.push(m);for(let y in d)K(n.attribute,y,d[y])}),n.content.default=s;let u=l.bindAttribute.model+"."+d.modelValue;n.bindAttribute.activeKey=u,n.modelBind.activeKey=u}n.content&&n.content.default&&W(n.content.default)}})}function j(){const t=e.drawingMain.component;let n=t.attribute.drawingForm,l=n.bind[n.bindAttribute.model];if(t.name=="ExForm")Object.assign(t.attribute,l),t.content.default||(t.content.default=[]),W(t.content.default);else if(t.name=="ExGrid"){const d=[];for(let s in l)s=="columns"?(l[s].forEach(r=>{d.push({dataIndex:r.field,title:r.label,type:r.form_type||"",header:{name:"html",attribute:{class:"ex_admin_table_th_name","data-tag":"span"},content:{default:[r.label]}}})}),l.switch.indexOf("hideAction")==-1&&d.push({dataIndex:"ExAdminAction",title:"",header:{name:"html",attribute:{class:"ex_admin_table_th_name","data-tag":"span"},content:{default:[""]}}}),t.attribute.columns=d):s=="switch"?l.swtichOptions.forEach(r=>{t.attribute[r]=l[s].indexOf(r)>-1}):t.attribute[s]=l[s]}else if(t.name=="ADescriptions")for(let d in l)if(d=="items"){const s=[];l[d].forEach(r=>{var u;s.push({name:"ADescriptionsItem",attribute:{title:r.label,span:r.span},content:{default:[(u=t.attribute.data[r.field])!=null?u:"--"],label:[r.label]}})}),t.content.default=s}else t.attribute[d]=l[d];e.drawingMain.ref.forceUpdate(),e.isSave=!1}function N(t,n){t.forEach(l=>{let d;if(typeof l=="object"){if(l.name=="AFormItem"){const s=e.drawingMain.component;let r=l.content.default[0].attribute.drawingForm;e.settingFormList.push(r);let u=r.bindAttribute.model;ge(r.bind[u],r.attribute.exceptField||[]);const g=s.bindAttribute.model,p=s.bind[g];r.bind[u].default=p[r.bind[u].field],n.push(r.bind[u]),d=r.bind[u]}else if(l.name=="DraggableRender")N(l.attribute.list,n);else if(["ARow","ACol","ExFormMany","ATabs","ATabPane"].indexOf(l.name)>-1){let s=l.attribute.drawingForm,r=s.bindAttribute.model;ge(s.bind[r],s.attribute.exceptField||[]),n.push(s.bind[r]),d=s.bind[r]}l.content&&l.content.default&&d&&(d.content=[],N(l.content.default,d.content))}})}function ee(){e.settingFormList=[],q(),setTimeout(()=>{let t={};const n=e.drawingMain.component;let l=n.attribute.drawingForm.bindAttribute.model;if(t.config=n.attribute.drawingForm.bind[l],n.name=="ExForm"){t.type="form",t.component=[],N(n.content.default,t.component);let d=0;Ue(()=>{e.settingFormList.forEach(s=>{R[s.bindAttribute.ref].form.validate().then(()=>{d++,d==e.settingFormList.length&&G(t)}).catch(r=>{r.errorFields.forEach(u=>{let g=`\u3010${r.values.title}\u3011`||"\u3010\u3011";Ke.error(g+u.errors[0]),e.settingFormList=[]})})})})}else n.name=="ExGrid"?(t.type="grid",G(t)):n.name=="ADescriptions"&&(t.type="detail",G(t))},500)}function G(t){F({url:"ex-admin/plugin-curd-controller-Index/save",method:"post",data:{id:e.method[e.methodIndex].id,controller:e.controller[e.controllerIndex].name,class:e.controller[e.controllerIndex].class,function:e.method[e.methodIndex].name,setting:t}}).then(n=>{e.settingFormList=[],ue(e.methodIndex,!1),e.isSave=!0})}function le(t){e.drawingMain.ref=t}function H(){F("ex-admin/plugin-curd-controller-Index/getController?curd_ref="+h.attrs.curd_ref).then(t=>{e.controller=t.data.list,e.controllerForm=t.data.controllerForm})}function $(){F("ex-admin/plugin-curd-controller-Database/getTable").then(t=>{e.tables=t.data.map(n=>(n.tableName=n.name,n.dataRef=n,n.name=n.id,n.children=[],n.class="table-tree-node",n))})}function te(t){if(e.tableVisible=!1,!t){$();return}return new Promise(n=>{F("ex-admin/plugin-curd-controller-Database/getTableColumn?table="+t.dataRef.id).then(l=>{t.dataRef.children=l.data.map(d=>(d.id=t.id+d.field,d.name=d.field,d.table=t.id,d.parent=t,d.isLeaf=!0,d)),e.tables=[...e.tables],n()})})}function B(t){Fe.confirm({title:"\u5220\u9664\u8868",content:"\u786E\u8BA4\u5220\u9664\u8868\uFF0C\u4E0D\u53EF\u6062\u590D\uFF1F",onOk(){F.delete("/ex-admin/plugin-curd-controller-Database/grid",{data:{ex_admin_action:"delete",ex_admin_sidebar:!0,ids:[t]}}).then(n=>{$()})}})}function ne(t,n,l){Fe.confirm({title:"\u5220\u9664\u8868\u5B57\u6BB5",content:"\u786E\u8BA4\u5220\u9664\u8868\u5B57\u6BB5\uFF0C\u4E0D\u53EF\u6062\u590D\uFF1F",onOk(){F.delete("/ex-admin/plugin-curd-controller-Database/grid",{data:{ex_admin_action:"delete",ex_admin_trashed:"false",table:t,ids:[n]}}).then(d=>{te(l)})}})}function ae(t,n,l){e.tableTreeNode=l,e.tableModalTitle="\u7F16\u8F91\u5B57\u6BB5",e.tableModalRender=null,F.put("/ex-admin/plugin-curd-controller-Database/form",{table:t,field:n}).then(d=>{e.tableVisible=!0,e.tableModalRender=d,e.tableModalRender.footer=d.content.footer[0],delete e.tableModalRender.content.footer})}function de(){e.tableTreeNode=null,e.tableModalTitle="\u6DFB\u52A0\u8868",e.tableModalRender=null,F.post("/ex-admin/plugin-curd-controller-Database/tableForm").then(t=>{e.tableVisible=!0,e.tableModalRender=t,e.tableModalRender.footer=t.content.footer[0],delete e.tableModalRender.content.footer})}function c(){e.tableTreeNode=null,e.tableModalTitle="\u8868\u9884\u8BBE\u5B57\u6BB5",e.tableModalRender=null,F.post("/ex-admin/plugin-curd-controller-Database/presetFields").then(t=>{e.tableVisible=!0,e.tableModalRender=t,e.tableModalRender.footer=t.content.footer[0],delete e.tableModalRender.content.footer})}function b(t){e.tableTreeNode=null,e.tableModalTitle="\u7F16\u8F91\u8868",e.tableModalRender=null,F.post("/ex-admin/plugin-curd-controller-Database/tableForm",{id:t}).then(n=>{e.tableVisible=!0,e.tableModalRender=n,e.tableModalRender.footer=n.content.footer[0],delete e.tableModalRender.content.footer})}function T(t){e.tableModalTitle="\u5173\u8054\u8868(\u6A21\u578B)",e.tableModalRender=null,F.post("/ex-admin/plugin-curd-controller-Database/modelRelationForm",{table:t}).then(n=>{e.tableVisible=!0,e.tableModalRender=n,e.tableModalRender.footer=n.content.footer[0],delete e.tableModalRender.content.footer})}function Me(t){e.tableModalTitle="\u6DFB\u52A0\u8868\u5B57\u6BB5",e.tableModalRender=null,F.post("/ex-admin/plugin-curd-controller-Database/form",{table:t}).then(n=>{e.tableVisible=!0,e.tableModalRender=n,e.tableModalRender.footer=n.content.footer[0],delete e.tableModalRender.content.footer})}function ye(){e.methodIndex=-1,F({url:"ex-admin/plugin-curd-controller-Index/getMethod",method:"post",data:{curd_ref:h.attrs.curd_ref,class:e.controller[e.controllerIndex].class,controller:e.controller[e.controllerIndex].name,table:e.controller[e.controllerIndex].table,id:e.controller[e.controllerIndex].id}}).then(t=>{e.methodForm=t.data.methodForm,e.method=t.data.list})}function Ce(){F({url:"ex-admin/plugin-curd-controller-Index/deleteMethod",method:"post",data:{class:e.controller[e.controllerIndex].class,controller:e.controller[e.controllerIndex].name,method:e.method[e.methodIndex].name,id:e.method[e.methodIndex].id}}).then(t=>{e.methodIndex=-1,e.method.splice(e.methodIndex,1)})}function ke(){const t=e.controller[e.controllerIndex];F({url:"ex-admin/plugin-curd-controller-Index/deleteController",method:"post",data:{id:t.id,path:t.path}}).then(n=>{e.controllerIndex=-1,H(),e.method=[]})}function ue(t,n=!0){e.methodIndex=t,e.settingForm=null,F({url:"ex-admin/plugin-curd-controller-Index/render",method:"post",data:{class:e.controller[e.controllerIndex].class,function:e.method[e.methodIndex].name,var:[]}}).then(l=>{e.isSave=!0,z(l.data),e.drawingMain.component=l.data})}function xe(t,n){n.mouseenter=!0,e.tableTreeNode=n,e.tables=[...e.tables]}function Re(t,n){n.mouseenter=!1,e.tables=[...e.tables]}function we(t){t.newIndex!==t.oldIndex&&F.post("ex-admin/plugin-curd-controller-Database/sortField",{table:t.item.__draggable_context.element.table,field:t.item.__draggable_context.element.field,sort:t.newIndex})}function Ae(t){if(!t.component)return!1;let n=J.exports.cloneDeep(t.component);if(n.name=="AFormItem"){let d=n.content.default[0].attribute.drawingForm,s=d.bind[d.bindAttribute.model];if(d.attribute.key=ie(20),s.field||(s.field=ie(20)),n.attribute.validateFormField=e.drawingMain.component.bindAttribute.validateField,n.content.default[0].name=="ExFormMany"){let r=[];n.content.default[0].content={default:A(n.content.default[0].name,r,n.content.default[0])}}}let l=[];if(n.name=="ARow"){let d=[];n.content.default[0].content={default:A("ACol",d)},l=n.content.default,n.content={default:A(n.name,l,n)}}else if(n.name=="ACol")n.content={default:A(n.name,l,n)};else if(n.name=="ATabs"){let d=n.content.default[0];d.content={default:A("ATabPane",l,d)},n.content={default:[d]}}return n}function me(t){j()}function Ie(t){return!(!t.relatedContext.element.table&&!t.draggedContext.element.component)}function Te(t){if(t){const n=e.controller[e.controllerIndex];e.controllerEditForm=J.exports.cloneDeep(e.controllerForm);let l=e.controllerEditForm.content.content[0].attribute.params;l.id=n.id,l.class=n.class,l.path=n.path,l.title=n.title,l.name=n.name,l.table=n.table}}function Ee(t){if(t){const n=e.method[e.methodIndex];e.methodEditForm=J.exports.cloneDeep(e.methodForm);let l=e.methodEditForm.content.content[0].attribute.params;l.id=n.id,l.type=n.type,l.name=n.name,l.oldTitle=n.title}}return _e({onFieldMove:Ie,onMove:M,onCloneMove:Z,onEnd:me,onClone:Ae,relationTable:T,onFieldSort:we,addTable:de,presetFields:c,editTableField:ae,editTable:b,deleteTable:B,addTableField:Me,tableMouseLeave:Re,tableMouseenter:xe,onLoadTable:te,deleteTableField:ne,getController:H,watchModel:S,dragSave:ee,getRender:ue,getMethod:ye,deleteMethod:Ce,deleteController:ke,getTable:$,controllerFormVisible:Te,methodFormVisible:Ee,dragRef:se,drawingRef:ce,setRef:le,tableMenus:P},qe(e))}}),re=o=>(Ge("data-v-604097ba"),o=o(),He(),o),Qe=x(" \u6DFB\u52A0 "),Xe=x(" \u7F16\u8F91 "),Ye=x(" \u5220\u9664 "),Ze={class:"flex-column"},et={class:"title"},tt=re(()=>f("span",null,"\u63A7\u5236\u5668",-1)),nt={class:"flex-1-auto"},ot=["onContextmenu","onClick"],lt={class:"name"},at={class:"desc"},dt=x(" \u6DFB\u52A0 "),it=x(" \u7F16\u8F91 "),rt=x(" \u5220\u9664 "),st={class:"flex-column"},ct={class:"title"},ut=re(()=>f("span",null,"\u65B9\u6CD5",-1)),mt={class:"flex-1-auto"},ft=["onContextmenu","onClick"],bt={class:"name"},pt={class:"desc"},ht={class:"flex-column"},_t={style:{margin:"0 10px 10px 10px"}},gt=x("\u6DFB\u52A0\u8868"),vt=x("\u8868\u9884\u8BBE\u5B57\u6BB5"),Ft=["onMouseenter","onMouseleave"],Mt={class:"table-tree-title"},yt=["title"],Ct={key:0,class:"table-tree-action-table"},kt=["title"],xt=["onMouseenter","onMouseleave"],Rt={class:"table-tree-title"},wt=["title"],At={key:0,class:"table-tree-action"},It=["title"],Tt={class:"components"},Et={style:{display:"flex","align-items":"center",margin:"5px"}},Dt=re(()=>f("i",{class:"fas fa-layer-group"},null,-1)),Ot={style:{"margin-left":"5px"}},Vt={class:"components-draggable"},Lt={class:"components-item"},$t={class:"components-body"},St={class:"header"},zt=x("(ctrl+s)"),Nt={class:"drawing scrollbar",ref:"drawingRef"},Bt={style:{display:"none"}};function Pt(o,h,R,e,se,ce){const P=_("PlusOutlined"),C=_("render"),I=_("a-menu-item"),V=_("EditOutlined"),U=_("question-circle-outlined"),S=_("DeleteOutlined"),Y=_("a-popconfirm"),z=_("a-menu"),Z=_("ReloadOutlined"),M=_("a-button"),A=_("a-tooltip"),q=_("a-dropdown"),L=_("a-layout-sider"),W=_("a-modal"),j=_("reload-outlined"),N=_("a-space"),ee=_("a-input"),G=_("FolderOutlined"),le=_("NodeIndexOutlined"),H=_("FileOutlined"),$=_("draggable"),te=_("a-sub-menu"),B=_("a-tab-pane"),ne=_("a-tabs"),ae=_("a-layout-content"),de=_("a-layout");return v(),w(de,{class:"layout"},{default:i(()=>[a(L,{width:130,class:"controller scrollbar"},{default:i(()=>[a(q,{trigger:["contextmenu"],onVisibleChange:o.controllerFormVisible},{overlay:i(()=>[a(z,null,{default:i(()=>[a(I,null,{default:i(()=>[a(C,{data:o.controllerEditForm},{default:i(()=>[a(P),Qe]),_:1},8,["data"])]),_:1}),o.controllerIndex>-1?(v(),w(I,{key:0},{default:i(()=>[a(C,{data:o.controllerEditForm},{default:i(()=>[a(V),Xe]),_:1},8,["data"])]),_:1})):E("",!0),o.controllerIndex>-1?(v(),w(Y,{key:1,title:"\u786E\u8BA4\u5220\u9664\uFF1F",onConfirm:h[0]||(h[0]=c=>o.deleteController())},{icon:i(()=>[a(U,{style:{color:"red"}})]),default:i(()=>[a(I,null,{icon:i(()=>[a(S)]),default:i(()=>[Ye]),_:1})]),_:1})):E("",!0)]),_:1})]),default:i(()=>[f("div",Ze,[f("div",et,[tt,f("div",null,[a(C,{data:o.controllerForm},null,8,["data"]),a(M,{size:"small",shape:"circle",onClick:o.getController},{icon:i(()=>[a(Z)]),_:1},8,["onClick"])])]),f("ul",nt,[(v(!0),D(X,null,Q(o.controller,(c,b)=>(v(),D("li",{key:b,onContextmenu:O(T=>o.controllerIndex=b,["prevent"]),onClick:T=>{o.controllerIndex=b,o.getMethod()},class:oe(o.controllerIndex==b?"active":"")},[a(A,{placement:"bottom",mouseEnterDelay:1},{title:i(()=>[x(k(c.title),1)]),default:i(()=>[f("div",lt,k(c.title),1)]),_:2},1024),a(A,{placement:"bottom",mouseEnterDelay:1},{title:i(()=>[x(k(c.path),1)]),default:i(()=>[f("div",at,k(c.name),1)]),_:2},1024)],42,ot))),128))])])]),_:1},8,["onVisibleChange"])]),_:1}),a(L,{width:130,class:"controller scrollbar"},{default:i(()=>[a(q,{trigger:["contextmenu"],onVisibleChange:o.methodFormVisible},{overlay:i(()=>[a(z,null,{default:i(()=>[o.controllerIndex>-1?(v(),w(I,{key:0},{default:i(()=>[a(C,{data:o.methodForm},{default:i(()=>[a(P),dt]),_:1},8,["data"])]),_:1})):E("",!0),o.methodIndex>-1?(v(),w(I,{key:1},{default:i(()=>[a(C,{data:o.methodEditForm},{default:i(()=>[a(V),it]),_:1},8,["data"])]),_:1})):E("",!0),o.methodIndex>-1?(v(),w(Y,{key:2,title:"\u786E\u8BA4\u5220\u9664\uFF1F",onConfirm:h[1]||(h[1]=c=>o.deleteMethod())},{icon:i(()=>[a(U,{style:{color:"red"}})]),default:i(()=>[a(I,null,{icon:i(()=>[a(S)]),default:i(()=>[rt]),_:1})]),_:1})):E("",!0)]),_:1})]),default:i(()=>[f("div",st,[f("div",ct,[ut,f("div",null,[a(C,{disabled:o.controllerIndex==-1,data:o.methodForm},null,8,["disabled","data"]),a(M,{size:"small",shape:"circle",onClick:h[2]||(h[2]=c=>o.getMethod())},{icon:i(()=>[a(Z)]),_:1})])]),f("ul",mt,[(v(!0),D(X,null,Q(o.method,(c,b)=>(v(),D("li",{key:b,onContextmenu:O(T=>o.methodIndex=b,["prevent"]),onClick:T=>o.getRender(b),class:oe(o.methodIndex==b?"active":"")},[a(A,{placement:"bottom",mouseEnterDelay:1},{title:i(()=>[x(k(c.title),1)]),default:i(()=>[f("div",bt,k(c.title),1)]),_:2},1024),a(A,{placement:"bottom",mouseEnterDelay:1},{title:i(()=>[x(k(c.name),1)]),default:i(()=>[f("div",pt,k(c.name),1)]),_:2},1024)],42,ft))),128))])])]),_:1},8,["onVisibleChange"])]),_:1}),a(L,{width:300,class:"scrollbar",ref:"dragRef"},{default:i(()=>[a(ne,{type:"card",class:"curd-tabs"},{default:i(()=>[a(B,{key:"1",tab:"\u6570\u636E\u5E93",style:{height:"100%"}},{default:i(()=>[a(W,{visible:o.tableVisible,"onUpdate:visible":h[4]||(h[4]=c=>o.tableVisible=c),title:o.tableModalTitle,width:"1000px"},{footer:i(()=>[o.tableModalRender?(v(),w(C,{key:0,data:o.tableModalRender.footer},null,8,["data"])):E("",!0)]),default:i(()=>[a(C,{data:o.tableModalRender,onSuccess:h[3]||(h[3]=c=>o.onLoadTable(o.tableTreeNode))},null,8,["data"])]),_:1},8,["visible","title"]),f("div",ht,[f("div",_t,[a(N,{style:{"margin-bottom":"10px"}},{default:i(()=>[a(M,{onClick:o.addTable},{default:i(()=>[gt]),_:1},8,["onClick"]),a(M,{onClick:o.presetFields},{default:i(()=>[vt]),_:1},8,["onClick"]),a(M,{shape:"circle",size:"small",onClick:o.getTable},{icon:i(()=>[a(j)]),_:1},8,["onClick"])]),_:1}),a(ee,{value:o.searchTable,"onUpdate:value":h[5]||(h[5]=c=>o.searchTable=c),size:"small",placeholder:"\u641C\u7D22\u8868","allow-clear":""},null,8,["value"])]),a(z,{mode:"inline",class:"curd-table-tree",selectable:!1},{default:i(()=>[(v(!0),D(X,null,Q(o.tableMenus,c=>(v(),w(te,{key:c.id,onTitleClick:b=>o.onLoadTable(c)},{title:i(()=>[f("div",{onMouseenter:b=>o.tableMouseenter(b,c),onMouseleave:b=>o.tableMouseLeave(b,c)},[f("div",Mt,[a(G),f("div",{class:"field-title",title:c.name},k(c.name),9,yt),c.mouseenter?(v(),D("div",Ct,[a(M,{shape:"circle",size:"small",onClick:O(b=>o.onLoadTable(c),["stop"])},{icon:i(()=>[a(j)]),_:2},1032,["onClick"]),a(M,{shape:"circle",size:"small",onClick:O(b=>o.addTableField(c.id),["stop"])},{icon:i(()=>[a(P)]),_:2},1032,["onClick"]),a(M,{shape:"circle",size:"small",onClick:O(b=>o.editTable(c.id),["stop"])},{icon:i(()=>[a(V)]),_:2},1032,["onClick"]),a(M,{shape:"circle",size:"small",onClick:O(b=>o.relationTable(c.id),["stop"])},{icon:i(()=>[a(le)]),_:2},1032,["onClick"]),a(M,{shape:"circle",size:"small",onClick:O(b=>o.deleteTable(c.id),["stop"])},{icon:i(()=>[a(S)]),_:2},1032,["onClick"])])):E("",!0)]),f("div",{class:"field-title-desc",title:c.comment},k(c.comment),9,kt)],40,Ft)]),default:i(()=>[a($,{style:{width:"100%"},list:c.children,onSort:o.onFieldSort,clone:o.onClone,move:o.onFieldMove,onEnd:o.onEnd,group:{pull:"clone",put:!1},"item-key":"id"},{item:i(({element:b})=>[f("div",{onMouseenter:T=>o.tableMouseenter(T,b),onMouseleave:T=>o.tableMouseLeave(T,b)},[(v(),w(I,{key:b.id},{default:i(()=>[f("div",Rt,[a(H),f("div",{class:"field-title",title:b.name},k(b.name),9,wt),b.mouseenter?(v(),D("div",At,[a(M,{shape:"circle",size:"small",onClick:O(T=>o.editTableField(c.id,b.field,c),["stop"])},{icon:i(()=>[a(V)]),_:2},1032,["onClick"]),a(M,{shape:"circle",size:"small",onClick:O(T=>o.deleteTableField(c.id,b.field,c),["stop"])},{icon:i(()=>[a(S)]),_:2},1032,["onClick"])])):E("",!0)]),f("div",{class:"field-title-desc",title:b.comment},k(b.comment),9,It)]),_:2},1024))],40,xt)]),_:2},1032,["list","onSort","clone","move","onEnd"])]),_:2},1032,["onTitleClick"]))),128))]),_:1})])]),_:1}),a(B,{key:"2",tab:"\u8868\u5355\u8BBE\u8BA1",forceRender:""},{default:i(()=>[(v(!0),D(X,null,Q(o.componentList,c=>(v(),D("div",Tt,[f("div",Et,[Dt,f("div",Ot,k(c.label),1)]),f("div",Vt,[a($,{list:c.options,sort:!1,clone:o.onClone,onEnd:o.onEnd,move:o.onCloneMove,"chosen-class":"chosen-class",group:{name:"components",pull:"clone",put:!1}},{item:i(({element:b})=>[f("div",Lt,[f("div",$t,[f("i",{class:oe(b.icon)},null,2),x(" "+k(b.label),1)])])]),_:2},1032,["list","clone","onEnd","move"])])]))),256))]),_:1})]),_:1})]),_:1},512),a(ae,{class:"main"},{default:i(()=>[f("div",St,[a(N,null,{default:i(()=>[a(M,{onClick:o.dragSave},{default:i(()=>[f("span",{style:We(o.isSave?"":"color: red;")},"\u4FDD\u5B58",4),zt]),_:1},8,["onClick"])]),_:1})]),f("div",Nt,[a(C,{ref:c=>o.setRef(c),data:o.drawingMain.component},null,8,["data"])],512)]),_:1}),f("div",{class:"collapse",onClick:h[6]||(h[6]=c=>o.settingFormVisible=!o.settingFormVisible)},[f("i",{class:oe(o.settingFormVisible?"fas fa-angle-double-right":"fas fa-angle-double-left")},null,2)]),o.settingFormVisible?(v(),w(L,{key:0,width:360,class:"settingForm scrollbar"},{default:i(()=>[a(ne,{type:"card",class:"curd-tabs"},{default:i(()=>[o.settingForm?(v(),w(B,{key:"1",tab:"\u7EC4\u4EF6\u5C5E\u6027"},{default:i(()=>[a(C,{data:o.settingForm,onWatchModel:o.watchModel},null,8,["data","onWatchModel"])]),_:1})):E("",!0),a(B,{key:"2",tab:"\u5C5E\u6027",forceRender:""},{default:i(()=>[o.drawingMain.component?(v(),w(C,{key:0,data:o.drawingMain.component.attribute.drawingForm,onWatchModel:o.watchModel},null,8,["data","onWatchModel"])):E("",!0)]),_:1})]),_:1})]),_:1})):E("",!0),f("div",Bt,[(v(!0),D(X,null,Q(o.settingFormList,c=>(v(),w(C,{data:c,onWatchModel:o.watchModel},null,8,["data","onWatchModel"]))),256))])]),_:1})}var Dn=Le(Je,[["render",Pt],["__scopeId","data-v-604097ba"]]);export{Dn as default};
