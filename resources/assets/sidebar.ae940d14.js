import"./vue.fe178274.js";import{u as U}from"./use-http.3c23d3b4.js";import{c as H,t as W}from"./index.7ed09148.js";import{r as v,w as q,aW as d,aR as u,ar as m,bd as y,as as x,c as g,au as K,u as c,at as C,R as F,ai as _}from"./@vue.9a7efb20.js";import"./@babel.6cd0804c.js";import"./regenerator-runtime.8e24db72.js";import"./js-md5.5179c6be.js";import"./vue-router.ac7a6022.js";import"./js-cookie.31874410.js";import"./ant-design-vue.1ee395b3.js";import"./@ant-design.e295b84c.js";import"./@ctrl.fa7cbd46.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./dayjs.38e390ea.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./lodash.c9cf1bdb.js";import"./spark-md5.2cc5764b.js";import"./@vueuse.47cba78b.js";import"./vue-demi.819cf47c.js";import"./axios.e3200588.js";/* empty css                     */import"./clipboard.099d05c9.js";import"./markdown-it.80c3a67b.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.c97a8414.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.75eb798b.js";const G={class:"scrollbar"},I={key:0},J={style:{color:"#f50"}},M={key:1},Q={name:"ExSidebar",inheritAttrs:!1},we=Object.assign(Q,{props:{hideAll:Boolean,hideAdd:Boolean,hideEdit:Boolean,hideDel:Boolean,hideFilter:Boolean,hideTools:Boolean,isTree:Boolean,tools:[Object,Boolean],value:[String,Number],sourceList:{type:Array,default:[]},default:{type:[String,Number],default:void 0},field:{type:String,default:"group_id"},selectedField:String,fieldNames:Object,url:String,params:{type:Object,default:{}},searchPlaceholder:String},emits:["update:value"],setup(o,{emit:f}){const t=o,{loading:X,http:T}=U();let k,h=t.fieldNames.children,p=t.fieldNames.key,n=t.fieldNames.title;t.default!==void 0&&f("update:value",t.default);const N=v([t.default]),r=v(""),S=v(t.sourceList.map(e=>e[p])),B=v(!0),O=v(E(t.sourceList)),A=(e,a)=>{for(let l=0;l<a.length;l++){const s=a[l];s[h]&&(s[h].some(D=>D[p]===e)?k=s[p]:A(e,s[h])&&(k=A(e,s[h])))}return k},V=e=>{S.value=e,B.value=!1};q(r,e=>{S.value=t.sourceList.map(a=>a[n].indexOf(e)>-1?A(a[p],O.value):null).filter((a,l,s)=>a&&s.indexOf(a)===l),r.value=e,B.value=!0});const j=(e,a)=>{if(a.selected){const l=e[0];t.tools&&(t.tools.del.directive[0].value.data.ids=[l],t.tools.edit.attribute.reference.event.Click.custom[0].params.data[t.tools.edit.attribute.pk]=l),t.selectedField?f("update:value",a.node[t.selectedField]):f("update:value",l)}else f("update:value",null)};function E(e){if(t.isTree&&(e=H(e,p,t.fieldNames.pid,h)),e.length==0&&(N.value=[""],f("update:value","")),!t.hideAll){const a={};a[p]="",a[n]=W("Sidebar.all"),e.unshift(a)}return e}function b(){T({url:t.url,method:"post",data:t.params}).then(e=>{O.value=E(e)})}return(e,a)=>{const l=d("render"),s=d("reload-outlined"),D=d("a-button"),L=d("a-space"),P=d("search-outlined"),w=d("a-input"),z=d("a-tree"),R=d("a-card");return u(),m(R,{style:{height:"100%"},bodyStyle:{padding:"10px",height:"100%",display:"flex",flexDirection:"column"}},{default:y(()=>[o.hideTools?x("",!0):(u(),m(L,{key:0,style:{"margin-bottom":"10px"},size:15},{default:y(()=>[o.hideAdd?x("",!0):(u(),m(l,{key:0,data:o.tools.add,onSuccess:b},null,8,["data"])),o.hideEdit?x("",!0):(u(),m(l,{key:1,disabled:!o.value,data:o.tools.edit,onSuccess:b},null,8,["disabled","data"])),o.hideDel?x("",!0):(u(),m(l,{key:2,disabled:!o.value,data:o.tools.del,onSuccess:b},null,8,["disabled","data"])),g(D,{shape:"circle",size:"small",onClick:b},{icon:y(()=>[g(s)]),_:1})]),_:1})),o.hideFilter?x("",!0):(u(),m(w,{key:1,value:r.value,"onUpdate:value":a[0]||(a[0]=i=>r.value=i),placeholder:o.searchPlaceholder,style:{"margin-bottom":"8px"}},{prefix:y(()=>[g(P,{style:{color:"#c0c4cc"}})]),_:1},8,["value","placeholder"])),K("div",G,[g(z,{"expanded-keys":S.value,"tree-data":O.value,"auto-expand-parent":B.value,fieldNames:o.fieldNames,onExpand:V,onSelect:j,selectedKeys:N.value,"onUpdate:selectedKeys":a[1]||(a[1]=i=>N.value=i)},{title:y(i=>[i[c(n)]&&i[c(n)].indexOf(r.value)>-1?(u(),C("span",I,[F(_(i[c(n)].substr(0,i[c(n)].indexOf(r.value)))+" ",1),K("span",J,_(r.value),1),F(" "+_(i[c(n)].substr(i[c(n)].indexOf(r.value)+r.value.length)),1)])):(u(),C("span",M,_(i[c(n)]),1))]),_:1},8,["expanded-keys","tree-data","auto-expand-parent","fieldNames","selectedKeys"])])]),_:1})}}});export{we as default};
