import{a as v,v as $,_ as q,I as H,a0 as R,$ as m,h as o,O as c,y as h,W as p,i as _,P as L,w as f,j as k,k as T,l as D,L as Y}from"./dynamicTag.98ddbc91.js";import{l as G}from"./use-http.b742b921.9df4e65c.js";import"./vue.4c5758a0.js";import"./@babel.dd651e2b.js";import"./regenerator-runtime.8e24db72.js";import"./@vue.87afd1fa.js";import"./index.97f9c525.js";import"./js-md5.3cdd41c4.js";import"./vue-router.9a2c52dc.js";import"./js-cookie.31874410.js";import"./ant-design-vue.e954adc4.js";import"./@ant-design.8c82b126.js";import"./@ctrl.fa7cbd46.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./dayjs.0743a87f.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./lodash.28c974ad.js";import"./spark-md5.2cc5764b.js";import"./@vueuse.67682d36.js";import"./vue-demi.24ed2461.js";import"./axios.e3200588.js";/* empty css                     */import"./sortablejs.412b554c.js";import"./clipboard.89482ba1.js";import"./markdown-it.39ce48f9.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.169105cf.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";import"./@kangc.52338b19.js";const J={class:"ex_scrollbar"},V={key:0,class:"flex"},X={style:{color:"#f50"}},Z={key:0,class:"action"},ee={key:1,class:"flex"},te={key:0,class:"action"},ae={name:"ExSidebar",inheritAttrs:!1},le=Object.assign(ae,{props:{hideAll:Boolean,hideAdd:Boolean,hideEdit:Boolean,hideDel:Boolean,hideFilter:Boolean,hideTools:Boolean,isTree:Boolean,tools:[Object,Boolean],value:[String,Number],sourceList:{type:Array,default:[]},default:{type:[String,Number],default:void 0},field:{type:String,default:"group_id"},selectedField:String,fieldNames:Object,url:String,params:{type:Object,default:{}}},emits:["update:value"],setup(d,{emit:x}){const l=d,{loading:ie,http:U}=G();let S,y=l.fieldNames.children,s=l.fieldNames.key,r=l.fieldNames.title;l.default!==void 0&&x("update:value",l.default);const O=v([l.default]),n=v(""),b=v(-1),N=v(l.sourceList.map(e=>e[s])),B=v(!0),A=v(F(l.sourceList)),j=(e,t)=>{for(let i=0;i<t.length;i++){const u=t[i];u[y]&&(u[y].some(E=>E[s]===e)?S=u[s]:j(e,u[y])&&(S=j(e,u[y])))}return S},P=e=>{N.value=e,B.value=!1};$(n,e=>{N.value=l.sourceList.map(t=>t[r].indexOf(e)>-1?j(t[s],A.value):null).filter((t,i,u)=>t&&u.indexOf(t)===i),n.value=e,B.value=!0});const w=(e,t)=>{if(t.selected){const i=e[0];l.selectedField?x("update:value",t.node[l.selectedField]):x("update:value",i)}else x("update:value",null)};function F(e){if(l.isTree&&(e=q(e,s,l.fieldNames.pid,y)),e.length==0&&(O.value=[""],x("update:value","")),!l.hideAll){const t={};t[s]="",t[r]=H("Sidebar.all"),t.ex_admin_render={name:"html",attribute:{"data-tag":"span"},content:{default:[t[r]]}},e.unshift(t)}return e}R.on(e=>{e=="Success"&&g()});function g(){U({url:l.url,method:"post",data:l.params}).then(e=>{A.value=F(e)})}function z(e){let t=e.node[s];t&&(b.value=t)}function I(){b.value=-1}return(e,t)=>{const i=m("render"),u=m("reload-outlined"),E=m("a-button"),K=m("a-space"),M=m("search-outlined"),W=m("a-input"),C=m("a-tree"),Q=m("a-card");return o(),c(Q,{style:{height:"100%"},bodyStyle:{padding:"10px",height:"100%",display:"flex",flexDirection:"column"}},{default:h(()=>[d.hideTools?p("",!0):(o(),c(K,{key:0,style:{"margin-bottom":"10px"},size:10},{default:h(()=>[d.hideAdd?p("",!0):(o(),c(i,{key:0,data:d.tools.add},null,8,["data"])),_(E,{shape:"circle",size:"small",onClick:g},{icon:h(()=>[_(u)]),_:1})]),_:1})),d.hideFilter?p("",!0):(o(),c(W,{key:1,value:n.value,"onUpdate:value":t[0]||(t[0]=a=>n.value=a),style:{"margin-bottom":"8px"}},{prefix:h(()=>[_(M,{style:{color:"#c0c4cc"}})]),_:1},8,["value"])),L("div",J,[_(C,{"expanded-keys":N.value,"tree-data":A.value,"auto-expand-parent":B.value,fieldNames:d.fieldNames,onExpand:P,onSelect:w,onMouseenter:z,onMouseleave:I,"block-node":"",selectedKeys:O.value,"onUpdate:selectedKeys":t[1]||(t[1]=a=>O.value=a)},{title:h(a=>[n.value&&a[f(r)]&&a[f(r)].indexOf(n.value)>-1?(o(),k("span",V,[L("span",null,[T(D(a[f(r)].substr(0,a[f(r)].indexOf(n.value)))+" ",1),L("span",X,D(n.value),1),T(" "+D(a[f(r)].substr(a[f(r)].indexOf(n.value)+n.value.length)),1)]),b.value==a[f(s)]&&(a.ex_admin_edit||a.ex_admin_delete)?(o(),k("span",Z,[d.hideEdit?p("",!0):(o(),c(i,{key:0,data:a.ex_admin_edit},null,8,["data"])),d.hideDel?p("",!0):(o(),c(i,{key:1,data:a.ex_admin_delete,onSuccess:g},null,8,["data"]))])):p("",!0)])):(o(),k("span",ee,[_(i,{data:a.ex_admin_render},null,8,["data"]),b.value==a[f(s)]&&(a.ex_admin_edit||a.ex_admin_delete)?(o(),k("span",te,[d.hideEdit?p("",!0):(o(),c(i,{key:0,data:a.ex_admin_edit},null,8,["data"])),d.hideDel?p("",!0):(o(),c(i,{key:1,data:a.ex_admin_delete,onSuccess:g},null,8,["data"]))])):p("",!0)]))]),_:1},8,["expanded-keys","tree-data","auto-expand-parent","fieldNames","selectedKeys"])])]),_:1})}}});var Ye=Y(le,[["__scopeId","data-v-b6eb703a"]]);export{Ye as default};
