import"./vue.ba0abfb8.js";import{u as R}from"./use-http.3c438523.js";import{b as U,t as z}from"./index.0b3984ff.js";import{r as v,w as E,aW as p,aR as d,ar as m,bd as x,as as h,c as K,au as T,u,at as V,R as j,ai as b}from"./@vue.cfb5b4bf.js";import"./vue-router.49809928.js";import"./@vueuse.87c3d595.js";import"./vue-demi.a71c3140.js";import"./js-md5.5179c6be.js";import"./@babel.6cd0804c.js";import"./regenerator-runtime.8e24db72.js";import"./lodash.c9cf1bdb.js";import"./spark-md5.2cc5764b.js";import"./axios.e3200588.js";import"./ant-design-vue.ad0ac899.js";import"./@ant-design.ad6c0a17.js";import"./@ctrl.fa7cbd46.js";import"./resize-observer-polyfill.8deb1e21.js";import"./vue-types.6e6d84ba.js";import"./dom-align.f1b5d360.js";import"./lodash-es.0ea26897.js";import"./dayjs.38e390ea.js";import"./async-validator.5d25c98b.js";import"./scroll-into-view-if-needed.5191fdbf.js";import"./compute-scroll-into-view.6058b3be.js";import"./js-cookie.31874410.js";/* empty css                     */import"./clipboard.099d05c9.js";import"./markdown-it.20180ffc.js";import"./entities.0d2c0164.js";import"./uc.micro.981ceb7b.js";import"./mdurl.ef76b4dc.js";import"./linkify-it.92c30060.js";import"./markdown-it-emoji.e3e91710.js";import"./escape-html.e5dfadb9.js";import"./prismjs.1971588a.js";import"./diacritics.6be19c75.js";import"./markdown-it-container.512a5043.js";import"./markdown-it-anchor.c88e5394.js";import"./markdown-it-attrs.3af5ab50.js";import"./markdown-it-table-of-contents.8a4ce16f.js";const H={class:"scrollbar"},W={key:0},q={style:{color:"#f50"}},G={key:1},I={name:"ExSidebar",inheritAttrs:!1},Ce=Object.assign(I,{props:{hideAll:Boolean,hideAdd:Boolean,hideEdit:Boolean,hideDel:Boolean,hideFilter:Boolean,hideTools:Boolean,isTree:Boolean,tools:[Object,Boolean],value:[String,Number],sourceList:{type:Array,default:[]},default:{type:[String,Number],default:""},field:{type:String,default:"group_id"},fieldNames:Object,url:String,params:{type:Object,default:{}}},emits:["update:value"],setup(o,{emit:g}){const a=o,{loading:J,http:C}=R();let N,f=a.fieldNames.children,c=a.fieldNames.key,i=a.fieldNames.title;a.default&&g("update:value",a.default);const y=v([a.default]),r=v(""),k=v(a.sourceList.map(e=>e[c])),B=v(!0),_=v(D(a.sourceList)),S=(e,t)=>{for(let s=0;s<t.length;s++){const n=t[s];n[f]&&(n[f].some(A=>A[c]===e)?N=n[c]:S(e,n[f])&&(N=S(e,n[f])))}return N},L=e=>{k.value=e,B.value=!1};E(r,e=>{k.value=a.sourceList.map(t=>t[i].indexOf(e)>-1?S(t[c],_.value):null).filter((t,s,n)=>t&&n.indexOf(t)===s),r.value=e,B.value=!0}),E(y,e=>{const t=e[0];a.tools&&(a.tools.del.directive[0].value.data.ids=[t],a.tools.edit.attribute.reference.event.Click.custom[0].params.data.id=t),g("update:value",t)});function D(e){if(a.isTree&&(e=U(e,c,a.fieldNames.pid,f)),e.length==0&&(y.value=[""],g("update:value","")),!a.hideAll){const t={};t[c]="",t[i]=z("Sidebar.all"),e.unshift(t)}return e}function O(){C({url:a.url,method:"post",data:a.params}).then(e=>{_.value=D(e)})}return(e,t)=>{const s=p("render"),n=p("a-space"),A=p("search-outlined"),w=p("a-input"),F=p("a-tree"),P=p("a-card");return d(),m(P,{style:{height:"100%"},bodyStyle:{padding:"10px",height:"100%",display:"flex",flexDirection:"column"}},{default:x(()=>[o.hideTools?h("",!0):(d(),m(n,{key:0,style:{"margin-bottom":"10px"},size:15},{default:x(()=>[o.hideAdd?h("",!0):(d(),m(s,{key:0,data:o.tools.add,onSuccess:O},null,8,["data"])),o.hideEdit?h("",!0):(d(),m(s,{key:1,disabled:!o.value,data:o.tools.edit,onSuccess:O},null,8,["disabled","data"])),o.hideDel?h("",!0):(d(),m(s,{key:2,disabled:!o.value,data:o.tools.del,onSuccess:O},null,8,["disabled","data"]))]),_:1})),o.hideFilter?h("",!0):(d(),m(w,{key:1,value:r.value,"onUpdate:value":t[0]||(t[0]=l=>r.value=l),style:{"margin-bottom":"8px"}},{prefix:x(()=>[K(A,{style:{color:"#c0c4cc"}})]),_:1},8,["value"])),T("div",H,[K(F,{"expanded-keys":k.value,"tree-data":_.value,"auto-expand-parent":B.value,fieldNames:o.fieldNames,onExpand:L,selectedKeys:y.value,"onUpdate:selectedKeys":t[1]||(t[1]=l=>y.value=l)},{title:x(l=>[l[u(i)]&&l[u(i)].indexOf(r.value)>-1?(d(),V("span",W,[j(b(l[u(i)].substr(0,l[u(i)].indexOf(r.value)))+" ",1),T("span",q,b(r.value),1),j(" "+b(l[u(i)].substr(l[u(i)].indexOf(r.value)+r.value.length)),1)])):(d(),V("span",G,b(l[u(i)]),1))]),_:1},8,["expanded-keys","tree-data","auto-expand-parent","fieldNames","selectedKeys"])])]),_:1})}}});export{Ce as default};
